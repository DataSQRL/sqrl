>>>database
CREATE INDEX IF NOT EXISTS orders$6_hash_c2 ON orders$6 USING hash (id);
CREATE INDEX IF NOT EXISTS orders$6_hash_c3 ON orders$6 USING hash (customerid);
CREATE INDEX IF NOT EXISTS orders$6_hash_c5 ON orders$6 USING hash (timestamp);
CREATE INDEX IF NOT EXISTS products$11_hash_c3 ON products$11 USING hash (name);
CREATE TABLE IF NOT EXISTS customers$13 (id BIGINT NOT NULL,timestamp TIMESTAMPTZ NOT NULL , PRIMARY KEY (id));
CREATE TABLE IF NOT EXISTS items$7 (_uuid VARCHAR NOT NULL,_idx BIGINT NOT NULL,productid BIGINT NOT NULL,quantity BIGINT NOT NULL,unit_price FLOAT NOT NULL,discount FLOAT ,discount$0 FLOAT NOT NULL,total FLOAT NOT NULL,timestamp TIMESTAMPTZ NOT NULL , PRIMARY KEY (_uuid,_idx));
CREATE TABLE IF NOT EXISTS orders$6 (_uuid VARCHAR NOT NULL,_ingest_time TIMESTAMPTZ NOT NULL,id BIGINT NOT NULL,customerid BIGINT NOT NULL,time BIGINT NOT NULL,timestamp TIMESTAMPTZ NOT NULL , PRIMARY KEY (_uuid));
CREATE TABLE IF NOT EXISTS past_purchases$17 (__pk_0 BIGINT NOT NULL,productid BIGINT NOT NULL,num_orders BIGINT NOT NULL,total_quantity BIGINT NOT NULL,timestamp TIMESTAMPTZ NOT NULL , PRIMARY KEY (__pk_0,productid));
CREATE TABLE IF NOT EXISTS products$11 (id BIGINT NOT NULL,_uuid VARCHAR NOT NULL,_ingest_time TIMESTAMPTZ NOT NULL,name VARCHAR NOT NULL,sizing VARCHAR NOT NULL,weight_in_gram BIGINT NOT NULL,type VARCHAR NOT NULL,category VARCHAR NOT NULL,usda_id BIGINT NOT NULL,updated TIMESTAMPTZ NOT NULL , PRIMARY KEY (id));
CREATE TABLE IF NOT EXISTS spending_by_month$15 (__pk_0 BIGINT NOT NULL,month TIMESTAMPTZ NOT NULL,total_spend FLOAT NOT NULL,total_savings FLOAT NOT NULL , PRIMARY KEY (__pk_0,month));
CREATE TABLE IF NOT EXISTS totals$9 (__pk_0 VARCHAR NOT NULL,price FLOAT NOT NULL,savings FLOAT NOT NULL,timestamp TIMESTAMPTZ NOT NULL , PRIMARY KEY (__pk_0));
CREATE TABLE IF NOT EXISTS volume_by_day$19 (__pk_0 BIGINT NOT NULL,day TIMESTAMPTZ NOT NULL,quantity BIGINT NOT NULL,total FLOAT NOT NULL,total_weight BIGINT NOT NULL , PRIMARY KEY (__pk_0,day));
DROP INDEX IF EXISTS orders$6_hash_c2;
DROP INDEX IF EXISTS orders$6_hash_c3;
DROP INDEX IF EXISTS orders$6_hash_c5;
DROP INDEX IF EXISTS products$11_hash_c3;
DROP TABLE IF EXISTS customers$13;
DROP TABLE IF EXISTS items$7;
DROP TABLE IF EXISTS orders$6;
DROP TABLE IF EXISTS past_purchases$17;
DROP TABLE IF EXISTS products$11;
DROP TABLE IF EXISTS spending_by_month$15;
DROP TABLE IF EXISTS totals$9;
DROP TABLE IF EXISTS volume_by_day$19;
>>>query-{
Customers {
    id
    spending_by_month {
        month
        total_spend
        total_savings
    }
}}
{"data":{"Customers":[{"id":1,"spending_by_month":[{"month":"2022-12-02T01:58:29.999Z","total_spend":225.76999999999998,"total_savings":14.73},{"month":"2022-11-01T13:29:23.999Z","total_spend":95.53,"total_savings":1.24}]},{"id":2,"spending_by_month":[{"month":"2022-12-02T01:58:29.999Z","total_spend":336.64,"total_savings":50.49},{"month":"2022-11-01T13:29:23.999Z","total_spend":139.86,"total_savings":29.08}]},{"id":3,"spending_by_month":[{"month":"2022-12-02T01:58:29.999Z","total_spend":20.64,"total_savings":0.0},{"month":"2022-11-01T13:29:23.999Z","total_spend":53.94,"total_savings":0.0}]},{"id":4,"spending_by_month":[{"month":"2022-12-02T01:58:29.999Z","total_spend":98.75,"total_savings":7.0},{"month":"2022-11-01T13:29:23.999Z","total_spend":118.5,"total_savings":18.28}]},{"id":5,"spending_by_month":[{"month":"2022-12-02T01:58:29.999Z","total_spend":149.07999999999998,"total_savings":4.43},{"month":"2022-11-01T13:29:23.999Z","total_spend":105.55000000000001,"total_savings":65.73}]},{"id":6,"spending_by_month":[{"month":"2022-12-02T01:58:29.999Z","total_spend":172.84,"total_savings":12.64},{"month":"2022-11-01T13:29:23.999Z","total_spend":36.55,"total_savings":16.87}]},{"id":7,"spending_by_month":[{"month":"2022-12-02T01:58:29.999Z","total_spend":86.94,"total_savings":7.94},{"month":"2022-11-01T13:29:23.999Z","total_spend":23.83,"total_savings":0.0}]},{"id":8,"spending_by_month":[{"month":"2022-12-02T01:58:29.999Z","total_spend":118.53999999999999,"total_savings":7.26},{"month":"2022-11-01T13:29:23.999Z","total_spend":17.59,"total_savings":5.27}]},{"id":9,"spending_by_month":[{"month":"2022-12-02T01:58:29.999Z","total_spend":78.83,"total_savings":5.95},{"month":"2022-11-01T13:29:23.999Z","total_spend":94.36000000000001,"total_savings":21.880000000000003}]},{"id":10,"spending_by_month":[{"month":"2022-12-02T01:58:29.999Z","total_spend":104.33000000000001,"total_savings":35.410000000000004},{"month":"2022-11-01T13:29:23.999Z","total_spend":84.18,"total_savings":4.24}]}]}}
