"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[5612],{6764:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>i,contentTitle:()=>d,default:()=>h,frontMatter:()=>r,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"functions-docs/function-docs/system-functions","title":"System Functions","description":"The following system functions are added to Flink\'s built-in system functions to support additional types and functionality.","source":"@site/docs/functions-docs/function-docs/system-functions.md","sourceDirName":"functions-docs/function-docs","slug":"/functions-docs/function-docs/system-functions","permalink":"/docs/functions-docs/function-docs/system-functions","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Functions","permalink":"/docs/functions"},"next":{"title":"Library Functions","permalink":"/docs/functions-docs/function-docs/library-functions"}}');var c=s(4848),o=s(8453);const r={},d="System Functions",i={},l=[{value:"JSONB Functions",id:"jsonb-functions",level:2},{value:"Vector Functions",id:"vector-functions",level:2},{value:"Text Functions",id:"text-functions",level:2}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,o.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.header,{children:(0,c.jsx)(n.h1,{id:"system-functions",children:"System Functions"})}),"\n",(0,c.jsxs)(n.p,{children:["The following system functions are added to ",(0,c.jsx)(n.a,{href:"https://nightlies.apache.org/flink/flink-docs-master/docs/dev/table/functions/systemfunctions/",children:"Flink's built-in system functions"})," to support additional types and functionality."]}),"\n",(0,c.jsx)(n.h2,{id:"jsonb-functions",children:"JSONB Functions"}),"\n",(0,c.jsx)(n.p,{children:"The binary JSON type (jsonb) uses a more efficient representation of JSON data and allows for native support of JSON in formats and connectors, like mapping to Postgre's JSONB column type."}),"\n",(0,c.jsx)(n.p,{children:"The following system functions create and manipulate binary JSON data."}),"\n",(0,c.jsxs)(n.table,{children:[(0,c.jsx)(n.thead,{children:(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.th,{children:"Function Name"}),(0,c.jsx)(n.th,{children:"Description"}),(0,c.jsx)(n.th,{children:"Example Usage"})]})}),(0,c.jsxs)(n.tbody,{children:[(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"to_jsonb"})}),(0,c.jsxs)(n.td,{children:["Parses a JSON string or Flink object (e.g., ",(0,c.jsx)(n.code,{children:"Row"}),", ",(0,c.jsx)(n.code,{children:"Row[]"}),") into a JSON object."]}),(0,c.jsxs)(n.td,{children:[(0,c.jsx)(n.code,{children:'to_jsonb(\'{"name":"Alice"}\')'})," \u2192 JSON object"]})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"jsonb_to_string"})}),(0,c.jsx)(n.td,{children:"Serializes a JSON object into a JSON string."}),(0,c.jsxs)(n.td,{children:[(0,c.jsx)(n.code,{children:"jsonb_to_string(to_jsonb('{\"a\":1}'))"})," \u2192 ",(0,c.jsx)(n.code,{children:"'{\"a\":1}'"})]})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"jsonb_object"})}),(0,c.jsx)(n.td,{children:"Constructs a JSON object from key-value pairs. Keys must be strings."}),(0,c.jsxs)(n.td,{children:[(0,c.jsx)(n.code,{children:"jsonb_object('a', 1, 'b', 2)"})," \u2192 ",(0,c.jsx)(n.code,{children:'{"a":1,"b":2}'})]})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"jsonb_array"})}),(0,c.jsx)(n.td,{children:"Constructs a JSON array from multiple values or JSON objects."}),(0,c.jsxs)(n.td,{children:[(0,c.jsx)(n.code,{children:"jsonb_array(1, 'a', to_jsonb('{\"b\":2}'))"})," \u2192 ",(0,c.jsx)(n.code,{children:'[1,"a",{"b":2}]'})]})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"jsonb_extract"})}),(0,c.jsx)(n.td,{children:"Extracts a value from a JSON object using a JSONPath expression. Optionally specify default value."}),(0,c.jsxs)(n.td,{children:[(0,c.jsx)(n.code,{children:"jsonb_extract(to_jsonb('{\"a\":1}'), '$.a')"})," \u2192 ",(0,c.jsx)(n.code,{children:"1"})]})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"jsonb_query"})}),(0,c.jsx)(n.td,{children:"Executes a JSONPath query on a JSON object and returns the result as a JSON string."}),(0,c.jsxs)(n.td,{children:[(0,c.jsx)(n.code,{children:"jsonb_query(to_jsonb('{\"a\":[1,2]}'), '$.a')"})," \u2192 ",(0,c.jsx)(n.code,{children:"'[1,2]'"})]})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"jsonb_exists"})}),(0,c.jsxs)(n.td,{children:["Returns ",(0,c.jsx)(n.code,{children:"TRUE"})," if a JSONPath exists within a JSON object."]}),(0,c.jsxs)(n.td,{children:[(0,c.jsx)(n.code,{children:"jsonb_exists(to_jsonb('{\"a\":1}'), '$.a')"})," \u2192 ",(0,c.jsx)(n.code,{children:"TRUE"})]})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"jsonb_concat"})}),(0,c.jsx)(n.td,{children:"Merges two JSON objects. If keys overlap, the second object's values are used."}),(0,c.jsxs)(n.td,{children:[(0,c.jsx)(n.code,{children:"jsonb_concat(to_jsonb('{\"a\":1}'), to_jsonb('{\"b\":2}'))"})," \u2192 ",(0,c.jsx)(n.code,{children:'{"a":1,"b":2}'})]})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"jsonb_array_agg"})}),(0,c.jsx)(n.td,{children:"Aggregate function: accumulates values into a JSON array."}),(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"SELECT jsonb_array_agg(col) FROM tbl"})})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"jsonb_object_agg"})}),(0,c.jsx)(n.td,{children:"Aggregate function: accumulates key-value pairs into a JSON object."}),(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"SELECT jsonb_object_agg(key_col, val_col) FROM tbl"})})]})]})]}),"\n",(0,c.jsx)(n.h2,{id:"vector-functions",children:"Vector Functions"}),"\n",(0,c.jsx)(n.p,{children:"The vector type supports efficient representation of large numeric vector, e.g. for embeddings."}),"\n",(0,c.jsx)(n.p,{children:"Use the following system functions to manipulate, convert, and aggregate vectors."}),"\n",(0,c.jsxs)(n.table,{children:[(0,c.jsx)(n.thead,{children:(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.th,{children:"Function Name"}),(0,c.jsx)(n.th,{children:"Description"}),(0,c.jsx)(n.th,{children:"Example Usage"})]})}),(0,c.jsxs)(n.tbody,{children:[(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"cosine_similarity"})}),(0,c.jsx)(n.td,{children:"Computes cosine similarity between two vectors."}),(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"cosine_similarity(vec1, vec2)"})})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"cosine_distance"})}),(0,c.jsx)(n.td,{children:"Computes cosine distance between two vectors (1 - cosine similarity)."}),(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"cosine_distance(vec1, vec2)"})})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"euclidean_distance"})}),(0,c.jsx)(n.td,{children:"Computes the Euclidean distance between two vectors."}),(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"euclidean_distance(vec1, vec2)"})})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"double_to_vector"})}),(0,c.jsxs)(n.td,{children:["Converts a ",(0,c.jsx)(n.code,{children:"DOUBLE[]"})," array into a ",(0,c.jsx)(n.code,{children:"VECTOR"}),"."]}),(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"double_to_vector([1.0, 2.0, 3.0])"})})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"vector_to_double"})}),(0,c.jsxs)(n.td,{children:["Converts a ",(0,c.jsx)(n.code,{children:"VECTOR"})," into a ",(0,c.jsx)(n.code,{children:"DOUBLE[]"})," array."]}),(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"vector_to_double(vec)"})})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"center"})}),(0,c.jsx)(n.td,{children:"Computes the centroid (average) of a collection of vectors. Aggregate function."}),(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"SELECT center(vecCol) FROM vectors"})})]})]})]}),"\n",(0,c.jsx)(n.h2,{id:"text-functions",children:"Text Functions"}),"\n",(0,c.jsx)(n.p,{children:"Functions for text manipulations and search."}),"\n",(0,c.jsxs)(n.table,{children:[(0,c.jsx)(n.thead,{children:(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.th,{children:"Function Name"}),(0,c.jsx)(n.th,{children:"Description"})]})}),(0,c.jsxs)(n.tbody,{children:[(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"format(String, String...)"})}),(0,c.jsxs)(n.td,{children:["A function that formats text based on a format string and variable number of arguments. It uses Java's ",(0,c.jsx)(n.code,{children:"String.format"})," method internally. If the input text is ",(0,c.jsx)(n.code,{children:"null"}),", it returns ",(0,c.jsx)(n.code,{children:"null"}),". For example, ",(0,c.jsx)(n.code,{children:'Format("Hello %s!", "World")'}),' returns "Hello World!".']})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"text_search(String, String...)"})}),(0,c.jsxs)(n.td,{children:["Evaluates a query against multiple text fields and returns a score based on the frequency of query words in the texts. It tokenizes both the query and the texts, and scores based on the proportion of query words found in the text. For example, ",(0,c.jsx)(n.code,{children:'text_search("hello", "hello world")'})," returns ",(0,c.jsx)(n.code,{children:"1.0"}),"."]})]})]})]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(a,{...e})}):a(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>d});var t=s(6540);const c={},o=t.createContext(c);function r(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:r(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);