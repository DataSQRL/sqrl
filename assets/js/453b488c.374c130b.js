"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[4382],{3824:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>a,toc:()=>o});const a=JSON.parse('{"id":"compiler","title":"DataSQRL Command","description":"The DataSQRL command initializes, compiles, runs, and tests SQRL projects.","source":"@site/docs/compiler.md","sourceDirName":".","slug":"/compiler","permalink":"/docs/compiler","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Library Functions","permalink":"/docs/functions-library-generated"},"next":{"title":"\ud83e\udde0 Streaming Concepts","permalink":"/docs/intro/concepts"}}');var i=t(4848),s=t(8453);const r={},l="DataSQRL Command",d={},o=[{value:"Installation",id:"installation",level:2},{value:"Command Overview",id:"command-overview",level:2},{value:"Init Command",id:"init-command",level:2},{value:"Example",id:"example",level:3},{value:"Add-Func Command",id:"add-func-command",level:2},{value:"Example",id:"example-1",level:3},{value:"Compile Command",id:"compile-command",level:2},{value:"Example",id:"example-2",level:3},{value:"Output",id:"output",level:3},{value:"Run Command",id:"run-command",level:2},{value:"Example",id:"example-3",level:3},{value:"Engines",id:"engines",level:3},{value:"Data Access",id:"data-access",level:3},{value:"Data Persistence",id:"data-persistence",level:3},{value:"Deployment",id:"deployment",level:3},{value:"Test Command",id:"test-command",level:2},{value:"Example",id:"example-4",level:3},{value:"Test Execution Overview",id:"test-execution-overview",level:3},{value:"Exec Command",id:"exec-command",level:2},{value:"Example",id:"example-5",level:3}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"datasqrl-command",children:"DataSQRL Command"})}),"\n",(0,i.jsx)(n.p,{children:"The DataSQRL command initializes, compiles, runs, and tests SQRL projects."}),"\n",(0,i.jsx)(n.p,{children:"You invoke the DataSQRL command in your terminal or command line.\nChoose your operating system below or use Docker which works on any machine that has Docker installed."}),"\n",(0,i.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,i.jsx)(n.p,{children:"Always pull the latest Docker image to ensure you have the most recent updates:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker pull datasqrl/cmd:latest\n"})}),"\n",(0,i.jsx)(n.h2,{id:"command-overview",children:"Command Overview"}),"\n",(0,i.jsx)(n.p,{children:"The DataSQRL CLI provides the following commands:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker run --rm -v $PWD:/build datasqrl/cmd -h\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Usage: sqrl [-hV] [COMMAND]\n  -h, --help      Show this help message and exit.\n  -V, --version   Print version information and exit.\nCommands:\n  init      Initializes an empty SQRL project.\n  add-func  Adds a new function definition into the 'functions' folder of an\n              existing project.\n  compile   Compiles an SQRL project and produces all build artifacts.\n  test      Compiles, then tests a SQRL project.\n  run       Compiles, then runs a SQRL project in a lightweight, standalone\n              environment.\n  exec      Executes an already compiled SQRL script using its existing build\n              artifacts.\n"})}),"\n",(0,i.jsx)(n.admonition,{type:"warning",children:(0,i.jsxs)(n.p,{children:["You need to mount the current directory (",(0,i.jsx)(n.code,{children:"$PWD"})," or ",(0,i.jsx)(n.code,{children:"${PWD}"})," on Windows with Powershell) to the ",(0,i.jsx)(n.code,{children:"/build"}),"\ndirectory for file access in Docker."]})}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsxs)(n.p,{children:["Note that most commands accept package configuration files as arguments to configure all aspects of the project.\nSee the ",(0,i.jsx)(n.a,{href:"/docs/configuration",children:"configuration documentation"})," for more details."]})}),"\n",(0,i.jsx)(n.h2,{id:"init-command",children:"Init Command"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"init"})," command creates a new SQRL project with the necessary files and directory structure."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker run --rm -v $PWD/<project-folder>:/build datasqrl/cmd init -h\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Usage: sqrl init [-hV] [--batch] <projectType> <projectName>\nInitializes an empty SQRL project.\n      <projectType>   Project type. Valid values: STREAM, DATASET, API.\n      <projectName>   Project name \u2014 used as the base name for both the SQRL\n                        script and the package configuration files.\n      --batch         Use BATCH mode in Flink.\n  -h, --help          Show this help message and exit.\n  -V, --version       Print version information and exit.\n"})}),"\n",(0,i.jsx)(n.h3,{id:"example",children:"Example"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"mkdir my-project\n\ndocker run --rm -v $PWD/my-project:/build datasqrl/cmd init stream my-project\n"})}),"\n",(0,i.jsxs)(n.p,{children:["This creates a new streaming project named ",(0,i.jsx)(n.code,{children:"my-project"})," with the default configuration and directory structure."]}),"\n",(0,i.jsx)(n.h2,{id:"add-func-command",children:"Add-Func Command"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"add-func"})," command adds a new user-defined function (UDF) to an existing SQRL project."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker run --rm -v $PWD/<project-folder>:/build datasqrl/cmd add-func -h\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Usage: sqrl add-func [-hV] [--aggregate] <fnName>\nAdds a new function definition into the 'functions' folder of an existing\nproject.\n      <fnName>      Name of the function.\n      --aggregate   Adds an aggregate function instead of the default scalar\n                      one.\n  -h, --help        Show this help message and exit.\n  -V, --version     Print version information and exit.\n"})}),"\n",(0,i.jsx)(n.h3,{id:"example-1",children:"Example"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"mkdir my-project\n\ndocker run --rm -v $PWD/my-project:/build datasqrl/cmd add-func MyAwesomeFunction\n"})}),"\n",(0,i.jsxs)(n.p,{children:["This creates a new scalar function template in the ",(0,i.jsx)(n.code,{children:"functions/"})," directory.\nUse ",(0,i.jsx)(n.code,{children:"--aggregate"})," to create an aggregate function instead."]}),"\n",(0,i.jsx)(n.h2,{id:"compile-command",children:"Compile Command"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"compile"})," command processes a SQRL project into a deployable data pipeline.\nIt stages all files needed by the compiler in the ",(0,i.jsx)(n.code,{children:"build"})," directory and outputs the created deployment\nartifacts for all engines in the target folder (defaults to ",(0,i.jsx)(n.code,{children:"build/deploy"}),")."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker run --rm -v $PWD:/build datasqrl/cmd compile -h\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'Usage: sqrl compile [-BhV] [-t=<targetFolder>] [<packageFiles>...]\nCompiles an SQRL project and produces all build artifacts.\n      [<packageFiles>...]   Package configuration file(s) of the project.\n                              Default: "package.json".\n  -B, --batch-output        Run in batch output mode (disables colored output).\n  -h, --help                Show this help message and exit.\n  -t, --target=<targetFolder>\n                            Target folder for deployment artifacts and plans.\n                              Default: "build/deploy".\n  -V, --version             Print version information and exit.\n'})}),"\n",(0,i.jsx)(n.h3,{id:"example-2",children:"Example"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd my-project\n\n# Defaults to package.json\ndocker run --rm -v $PWD:/build datasqrl/cmd compile\n"})}),"\n",(0,i.jsx)(n.p,{children:"Or with a specific package configuration file:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd my-project\n\ndocker run --rm -v $PWD:/build datasqrl/cmd compile package-prod.json\n"})}),"\n",(0,i.jsx)(n.h3,{id:"output",children:"Output"}),"\n",(0,i.jsx)(n.p,{children:"Upon successful compilation, the compiler writes:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Data processing DAG to ",(0,i.jsx)(n.code,{children:"build/pipeline_explain.txt"})]}),"\n",(0,i.jsxs)(n.li,{children:["Visual representation to ",(0,i.jsx)(n.code,{children:"build/pipeline_visual.html"})," (open in browser to inspect the DAG)"]}),"\n",(0,i.jsx)(n.li,{children:"Deployment artifacts to the target folder"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"run-command",children:"Run Command"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"run"})," command compiles and runs the generated data pipeline in Docker."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker run --rm -it -p 8081:8081 -p 8888:8888 -p 9092:9092 -v $PWD:/build datasqrl/cmd run -h\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'Usage: sqrl run [-BhV] [-t=<targetFolder>] [<packageFiles>...]\nCompiles, then runs a SQRL project in a lightweight, standalone environment.\n      [<packageFiles>...]   Package configuration file(s) of the project.\n                              Default: "package.json".\n  -B, --batch-output        Run in batch output mode (disables colored output).\n  -h, --help                Show this help message and exit.\n  -t, --target=<targetFolder>\n                            Target folder for deployment artifacts and plans.\n                              Default: "build/deploy".\n  -V, --version             Print version information and exit.\n'})}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsxs)(n.p,{children:["Note the additional port mappings to access the individual data systems that are running the pipeline.\nAdditionally, ",(0,i.jsx)(n.code,{children:"run"})," loads ",(0,i.jsx)(n.a,{href:"https://raw.githubusercontent.com/DataSQRL/sqrl/refs/heads/main/sqrl-planner/src/main/resources/default-run-package.json",children:"configuration settings"}),"\nthat are applicable exclusively during runtime.\nThese ",(0,i.jsx)(n.code,{children:"run"}),"-specific configuration options will be replaced if they are defined in any custom package configuration file."]})}),"\n",(0,i.jsx)(n.h3,{id:"example-3",children:"Example"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd my-project\n\ndocker run --rm -it -p 8081:8081 -p 8888:8888 -p 9092:9092 --rm -v $PWD:/build datasqrl/cmd run\n"})}),"\n",(0,i.jsxs)(n.p,{children:["This compiles, then runs the SQRL project in the ",(0,i.jsx)(n.code,{children:"my-project"})," folder,\nexposing the Flink UI on port 8081, the Vert.x server on port 8888, and Redpanda on port 9092."]}),"\n",(0,i.jsx)(n.h3,{id:"engines",children:"Engines"}),"\n",(0,i.jsx)(n.p,{children:"The run command uses the following engines:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Flink as the stream engine: The Flink cluster is accessible through the WebUI at ",(0,i.jsx)(n.a,{href:"http://localhost:8081/",children:"http://localhost:8081/"}),"."]}),"\n",(0,i.jsx)(n.li,{children:"Postgres as the transactional database engine"}),"\n",(0,i.jsx)(n.li,{children:"Iceberg+DuckDB as the analytic database engine"}),"\n",(0,i.jsx)(n.li,{children:"Redpanda as the log engine: The Redpanda cluster is accessible on port 9092 (via Kafka command line tooling)."}),"\n",(0,i.jsxs)(n.li,{children:["Vertx as the server engine:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["The GraphQL API is accessible at ",(0,i.jsx)(n.a,{href:"http://localhost:8888/v1/graphiql/",children:"http://localhost:8888/v1/graphiql/"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["The Swagger UI for the REST API is accessible at ",(0,i.jsx)(n.a,{href:"http://localhost:8888/v1/swagger-ui",children:"http://localhost:8888/v1/swagger-ui"})]}),"\n",(0,i.jsxs)(n.li,{children:["The MCP API is accessible at ",(0,i.jsx)(n.code,{children:"http://localhost:8888/v1/mcp/"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"data-access",children:"Data Access"}),"\n",(0,i.jsx)(n.p,{children:"DataSQRL runs up the data systems listed above and maps your local directories for data access.\nTo access this data in your DataSQRL jobs during local execution use:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"${KAFKA_BOOTSTRAP_SERVERS}"})," to connect to the Redpanda Kafka cluster"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"${DATA_PATH}/"})," to reference ",(0,i.jsx)(n.code,{children:".jsonl"})," or ",(0,i.jsx)(n.code,{children:".csv"})," data in your project."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["This allows DataSQRL to map connectors correctly and also applies to ",(0,i.jsx)(n.a,{href:"#test-command",children:"testing"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"data-persistence",children:"Data Persistence"}),"\n",(0,i.jsx)(n.p,{children:"To preserve inserted data between runs, mount a directory for Redpanda to persist the data to:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker run -it -p 8081:8081 -p 8888:8888 -p 9092:9092 --rm -v /mydata/project:/data/redpanda -v $PWD:/build datasqrl/cmd run my-package.json\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The volume mount contains the data written to the log engine and persists it to the local ",(0,i.jsx)(n.code,{children:"/mydata/project"})," directory\nwhere you want to store the data (adjust as needed and make sure the directory exists)."]}),"\n",(0,i.jsxs)(n.p,{children:["When you terminate (via ",(0,i.jsx)(n.code,{children:"CTRL-C"}),") and re-run your SQRL project, it will replay prior data."]}),"\n",(0,i.jsx)(n.h3,{id:"deployment",children:"Deployment"}),"\n",(0,i.jsxs)(n.p,{children:["The run command is primarily used for local development and quick iteration cycles. It supports small-scale deployments.\nFor large-scale deployments, we recommend that you run the generated pipeline in Kubernetes by extending our ",(0,i.jsx)(n.a,{href:"https://github.com/DataSQRL/sqrl-k8s",children:"Kubernetes setup"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["If you prefer a managed service, you can use ",(0,i.jsx)(n.a,{href:"https://www.datasqrl.com/",children:"DataSQRL Cloud"})," for automated and optimized deployments.\nAlternatively, you can deploy the generated deployment artifacts in the ",(0,i.jsx)(n.code,{children:"build/plan"})," directory using available managed\nservices by your preferred cloud provider."]}),"\n",(0,i.jsx)(n.h2,{id:"test-command",children:"Test Command"}),"\n",(0,i.jsxs)(n.p,{children:["The test command compiles and runs the data pipeline, then executes the provided test API queries and API endpoints\nfor all tables annotated with ",(0,i.jsx)(n.code,{children:"/*+ test */"})," to snapshot the results."]}),"\n",(0,i.jsx)(n.p,{children:"When you first run the test command or add additional test cases, it will create the snapshots and fail.\nAll subsequent runs of the test command compare the results to the previously snapshotted results and succeed\nif the results are identical, else fail."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker run --rm -it -p 8081:8081 -p 8888:8888 -p 9092:9092 -v $PWD:/build datasqrl/cmd test -h\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'Usage: sqrl test [-BhV] [-t=<targetFolder>] [<packageFiles>...]\nCompiles, then tests a SQRL project.\n      [<packageFiles>...]   Package configuration file(s) of the project.\n                              Default: "package.json".\n  -B, --batch-output        Run in batch output mode (disables colored output).\n  -h, --help                Show this help message and exit.\n  -t, --target=<targetFolder>\n                            Target folder for deployment artifacts and plans.\n                              Default: "build/deploy".\n  -V, --version             Print version information and exit.\n'})}),"\n",(0,i.jsx)(n.h3,{id:"example-4",children:"Example"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker run --rm -it -p 8081:8081 -p 8888:8888 -p 9092:9092 -v $PWD:/build datasqrl/cmd test\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The Test Command related configuration can be adjusted via the ",(0,i.jsx)(n.a,{href:"/docs/configuration#test-runner-test-runner",children:(0,i.jsx)(n.code,{children:"test-runner"})})," configuration.\nThe ",(0,i.jsx)(n.code,{children:"tests"})," directory contains GraphQL queries that are executed against the API of the generated data pipeline."]}),"\n",(0,i.jsx)(n.h3,{id:"test-execution-overview",children:"Test Execution Overview"}),"\n",(0,i.jsx)(n.p,{children:"Subscriptions are registered first. This ensures that any incoming data events are captured as soon as they occur."}),"\n",(0,i.jsx)(n.p,{children:"Next, mutations are executed in alphabetical order. This controlled ordering allows predictable state changes during testing."}),"\n",(0,i.jsx)(n.p,{children:"Queries are executed after all mutations have been applied. This step retrieves the system state resulting from the preceding operations."}),"\n",(0,i.jsx)(n.p,{children:"Once all queries complete, the subscriptions are terminated and the data collected during their active phase is assembled into snapshots."}),"\n",(0,i.jsx)(n.admonition,{type:"warning",children:(0,i.jsx)(n.p,{children:"Subscriptions can only be tested in conjunction with mutations at this time."})}),"\n",(0,i.jsx)(n.h2,{id:"exec-command",children:"Exec Command"}),"\n",(0,i.jsx)(n.p,{children:"The exec command executes an already compiled SQRL project using its existing build artifacts, without recompiling.\nThis is useful when you want to run a previously compiled pipeline."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"run --rm -it -p 8081:8081 -p 8888:8888 -p 9092:9092 -v $PWD:/build datasqrl/cmd exec -h\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'Usage: sqrl exec [-BhV] [-t=<targetFolder>] [<packageFiles>...]\nExecutes an already compiled SQRL script using its existing build artifacts.\n      [<packageFiles>...]   Package configuration file(s) of the project.\n                              Default: "package.json".\n  -B, --batch-output        Run in batch output mode (disables colored output).\n  -h, --help                Show this help message and exit.\n  -t, --target=<targetFolder>\n                            Target folder for deployment artifacts and plans.\n                              Default: "build/deploy".\n  -V, --version             Print version information and exit.\n'})}),"\n",(0,i.jsx)(n.h3,{id:"example-5",children:"Example"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd my-project\n\ndocker run --rm -it -p 8081:8081 -p 8888:8888 -p 9092:9092 -v $PWD:/build datasqrl/cmd exec\n"})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>l});var a=t(6540);const i={},s=a.createContext(i);function r(e){const n=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),a.createElement(s.Provider,{value:n},e.children)}}}]);