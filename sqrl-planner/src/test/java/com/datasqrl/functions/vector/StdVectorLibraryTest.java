package com.datasqrl.functions.vector;

import static org.junit.jupiter.api.Assertions.assertEquals;

import com.datasqrl.vector.CenterAccumulator;
import com.datasqrl.vector.FlinkVectorType;
import com.datasqrl.vector.VectorFunctions;
import java.util.List;
import java.util.stream.Collectors;
import java.util.stream.Stream;
import org.junit.jupiter.api.Disabled;
import org.junit.jupiter.api.Test;

public class StdVectorLibraryTest {

  private static final double[][] VECTORS = {
      {-0.5585908660044273, -0.08634845974544685, 0.020703715194637578, 0.34847628759841126, 0.20789587365773818, 0.03587478461364905, 0.41937680581274134, 0.015324507529536882, 0.18487325500852117, 0.10180993708005796, -0.22784734222417077, -0.10590607346966863, -0.10924364564319451, -0.040051190104956426, 0.23508307718050978, -0.13821483170613647, 0.4077992528521766, -0.2423931419228514, 0.09487375314347446, -0.13259579686079329, -0.19703331092993417, -0.40226834220811725, 0.20460079020510116, -0.012683778846015533, 0.05543964938260615, 0.36318682056541246, 0.2693670925994714, 0.047698947601020336, -0.05317183490842581, 0.05140886067723235, -0.27595556201413274, 0.24876506762423864, 0.06721374935780962, -0.2884261558453242, -0.3830601618004342, 0.012084899683638165, 0.26839390823928017, -0.22832820867188275, 0.02434542899330457, -0.14070913459484777, -0.019241380970925093, 0.30478990574677783, 0.2598198918470492, 0.0154567591768379, -0.0623685068761309, -0.20972030384776494, 0.013643160617599884, -0.10303964201981823, 0.014180780776465932, 0.17791412398219109, -0.21253716805949807, 0.11846411561903854, -0.13891811007245755, 0.1296853443297247, 0.05679815992092093, 0.17791263192581633, -0.19073799074006578, -0.21668281988240778, -0.04404979688115418, 0.26005504144510877, -0.18331549099336067, -0.09793108659020315, -0.07670227081204455, -0.012681795284152031, 0.0021656941001613936, -0.3124406006342421, -0.19336854418118796, 0.039977135912825666, 0.16709515017767748, -0.25399289773001027, -0.11606364270361762, 0.349588821719711, 0.1911899509917324, -0.03656592903037866, -0.1954230002593249, 0.06453813977229099, 0.16867411136627197, -0.1652594394981861, 0.090997659911712, 0.36135985399596393, 0.06313385158622016, 0.009305109347527226, -0.00605391039668272, 0.10709491940603282, -0.17191071629834673, -0.3299314769683406, 0.17551569500938058, -0.12760339910164475, 0.005845341521004836, 0.251220625359565, 0.10056196995234738, 0.254576975198385, 0.26995876198634505, -0.10663117237466697, -0.20947796238275865, 0.16250184069698057, 0.07678333516620721, 0.25959059363231063, -0.18359671370126307, -0.21521447490279874, 0.041816262217859425, -0.09008302524064978, -0.21676729790245494, 0.09982977132312953, 0.1957377688959241, -0.042592473716164626, -0.2735262108229411, -0.28054347816699493, 0.17438662455727658, -0.03654222120530903, -0.15095903573092073, -0.17459406474760422, -0.17368856662263474, 0.04397102592580874, -0.09850889690763627, 0.17025047129330537, -0.02147578401491046, -0.03921638048874835, 0.05528370562630395, -0.06881248593951265, -0.3270060697880884, -0.09447368304245174, 0.14250197595295808, -0.03898216411471367, -0.12571273550080755, -0.03661914992456635, 0.1277813403867185, 2.231523976066307E-33, -0.1849384653226783, 0.03710053224737445, 0.12685415878271064, -0.04918446523758272, 0.27317873916278285, -0.20130534807685763, 0.054903529778433345, 0.00835023121908307, -0.16802153984705606, -0.11708967597223818, 0.01594103593379259, 0.1543352471974989, -0.15310474392026663, 0.18184726452454925, -0.015887018603583176, -0.3099077764588098, -0.12277086606870095, 0.11404572349662583, -0.3365975506991769, 0.19672428894167146, 0.14468899772812924, 0.039502020770063005, 0.3108877607931693, 0.28174984889725846, -0.1406432301737368, -0.10849107864002387, 0.18146489630453289, 0.11378596381594737, -0.07155518637349208, 0.06785944414635499, 0.25344829478611547, -0.24643419915810227, -0.14297938471039137, 0.1839554860877494, -0.1024538006943961, -0.06593621421294908, -0.04813851594614486, 0.04429491531724731, -0.07942908459032576, 0.26838003168813884, -0.2590946867906799, -0.1271056841360405, 0.006207085059334834, 0.05982001878631612, 0.037019203222977616, 0.24106882248694697, -0.09826971823349595, 0.0706709223644187, -0.08275626692920923, 0.02843816136009991, -0.19056430804387978, 0.04550283681601286, 0.2187101386177043, 0.2913854151653747, -0.02935553986268739, -0.07273678512622912, 0.027616191771812737, 0.1999636086790512, 0.030864646503080923, -0.09610597251836832, -0.39177397017677623, -0.22403636295348406, 0.02645101142115891, -0.20435384940356016, 0.05575020580242077, 0.16093460571331283, -0.1990146185271442, -0.2131598045428594, 0.07764680699134867, 0.010544730971256891, 0.4466204357643922, 0.16857840276012817, 0.16077639597157636, 0.08543678016091387, 0.1510898433625698, -0.17247028610048196, 0.04286954505369067, 0.06410998265103747, -0.030264180386438966, -0.09562731285889943, 0.10524272550052653, -0.023599613457918167, -0.05363875930197537, 0.17832765266454467, -0.14036270945022503, 0.08701875860181947, -0.10974166759600242, 0.005981919394495587, 0.16367085495342812, 0.0414346686253945, -0.25007557465384406, -0.1063692863099277, 0.4115303599586089, 0.19560734337816635, -0.06710025466357668, -5.276714305183255E-33, 0.3670029224207004, -0.27663846236343187, -0.11556590429972857, 0.1979240607470274, -0.25685312162386253, -0.00428008121283104, 0.05093328507306675, 0.02454925988179942, 0.3130491361177216, -0.08672000157336394, -0.011173639446496964, 0.0238125945130984, 0.00722082161034147, 0.16677582527821264, -0.11755356844514608, 0.12009439415608843, -0.11608344689011574, -0.09431356579686205, -0.11399540848409136, 0.2422999577053512, 0.09175307877982657, -0.050869628631820284, -0.36935209746782977, 0.1186267948942259, 0.260884340852499, 0.10295346022273104, 0.05111359618604183, -0.05997268884675577, -0.03338320444648465, 0.2508431605140989, -0.1649080558369557, 0.13084498001262546, -0.017736425002415974, -0.19999759132042527, 0.2022410056864222, 0.12535109091550112, -0.05932975905792167, -0.07618498631442587, -0.20499175794733068, 0.5039135732998451, -0.09234744345303625, 0.02855515363626182, 0.287573790565754, 0.1988810612820089, 0.19833662415233752, -0.032346640791123114, -0.30516874976456165, 0.07685224409215152, -0.14073595288209617, 0.1887433787342161, -0.05970450025051832, -0.12417840957641602, -0.2553517284492652, 0.05831322601685921, -0.10862704861210659, -0.09990955501173933, -0.06363655681100984, 0.016941352902601164, -0.2821214588669439, -0.13523255257556835, -0.0829602941327418, -0.1649695417533318, -0.10625555366277695, 0.08578353188931942, 0.031821434230854116, -0.1040524816683804, -0.17786266821591803, -0.34823700739070773, -0.08944409363903105, -0.3502409675469001, 0.21463807625696063, -0.36147556841994327, 0.037138666647175946, -0.041211293544620275, 0.2527674697339535, -0.0956832255081584, 0.18518730563422045, 0.16299103192674616, -0.18910567105437318, 0.24248633161187172, -0.05582932072381178, 0.5318655332084745, -0.23317211385195455, 0.0035926513373851776, -0.11174024734646082, 0.13536389513562122, 0.080880166128433, -0.2861124765283118, -0.0437163554597646, -0.07666190861103435, 0.11296884214971215, 8.020006741086642E-5, -0.40214871884866926, 0.16422727905834714, 0.20032715083410343, -1.0074640055535156E-7, -0.058497706234144665, 0.010743194492533803, 0.09056350239552557, 0.39032596023753285, 0.11629706947132945, -0.04541698175792893, -0.22970276174601167, -0.24399899450751641, -0.12242060682425897, -0.2229009501170367, 0.2366395630330468, 0.21092518764392784, -0.004246113899474342, 0.09598365449346602, -0.0733738267639031, -0.10354886863691111, 0.10994088106478254, -0.06979810143820941, 0.04536435194313526, 0.1836166661620761, -0.09065066448723276, -0.11325497242311637, 0.27516198973171413, -0.11898832504327099, 0.010726212911928693, 0.08464725016771506, 0.03140675730537623, -0.18186813111727437, 0.14676780606775233, -0.07329507016887267, -0.3271452649496496, 0.037245270039420575, 0.17485251533798873, 0.3170768888667226, 0.21936015567431846, -0.03297498560277745, 0.08677091255473594, -0.17997042244921127, -0.1661448248390419, -0.1352336898756524, -0.01636016632740696, -7.734658817450205E-4, -0.2711507390098025, -0.1954704454789559, -0.23810113112752637, -0.021520396946774174, 0.10614420993564029, -0.09417364529023568, 0.07485076517332345, 0.5129909844448169, -0.049681850631410875, -0.17678740325694284, 0.10098484139113377, 0.010878690828879675, 0.19483503041556105, 0.15442385434289463, -0.19719559132742384, 0.024027714583401878, -0.2786960864129166, -0.03477502536649505, 0.3267094234082227, 0.17241939576342702, -0.2553422339260578, -0.3175586489960551},
      {-0.4074448577507778, -0.06069307401776314, 0.03700825171890082, 0.28403938049450517, 0.16760074995734073, 0.13096446833676761, 0.34847088158130646, -0.014689811470883864, 0.09222663766532033, 0.1412397624441871, -0.22499213305612406, -0.17046199007718651, -0.045814974854389824, -0.059637542745029484, 0.22638936575364182, -0.12743957413153517, 0.12839933093292294, -0.15241284730533758, 0.13140203479539464, -0.14231171655572122, -0.12754605931264382, -0.38697776281171375, 0.2095964230183098, 0.02650930760083375, 0.07399320388557734, 0.30712560536684813, 0.1770070633954472, 0.15263651708071982, -0.036985920328232974, 0.26068830572896534, -0.17169400821957323, 0.2588687138976874, 0.07625726748395849, -0.1711515773570648, -0.33504051094253856, 0.02651916523636491, 0.23662791632253816, -0.1394352995687061, -0.0024029964374171365, -0.07943497784435749, 0.057646791002264726, 0.3655533165567451, 0.3856133670994529, 0.017922486057849945, 0.04954459238797426, -0.08250764609073047, -0.054457469964055, -0.20910184775237683, -0.04981011186760885, 0.16447748023050804, -0.12043425461484326, 0.1970380099007377, -0.0896494591401683, 0.06053402944019547, 0.03562374700171252, 0.07208770741191176, -0.10168347162780939, -0.17950788899152367, -0.15113880361119905, 0.1716576887777558, -0.08466430353345694, -0.13253188947284664, -0.18162897180903842, 0.06503660687141949, -0.03864775446278078, -0.27895782446419753, -0.0850153899303189, 0.10700292485179724, 0.08499910344404203, -0.2552624637674954, -0.09934587107488403, 0.35107856381822516, 0.22845324266839911, -0.030525749342309103, -0.2373864544486558, -0.05655929263405226, 0.19643260069467403, -0.05612578146435596, -0.03235126776551759, 0.30112122989225165, 0.09997914634920933, 0.008748701394156174, 0.20747866560877473, 0.06424374022969494, -0.24911227035853598, -0.21950234141614702, 0.14720365867294646, -0.14154904777253116, 0.0022466111652277134, 0.24917148671078462, -0.01605330421416848, 0.10332725420421748, 0.14176866362147308, -0.11808778052390725, -0.10497591610032099, 0.13745991064718477, 0.11897162341133312, 0.15627682678125523, -0.13387093865485103, -0.3398173728750812, 0.06944736272648529, -0.10005293472635525, -0.22217033913841955, -0.020695737804527634, 0.2583389000070316, -0.04266993293249807, -0.28566416663428146, -0.2738523777850248, 0.20180363759950357, -0.004861020103648857, -0.1417773319753232, -0.1700841593383639, -0.11991035138015393, 0.028642695983526884, 0.02852534789040133, 0.130534666141978, -0.055914126336574554, 0.011172424380977949, 0.0038786640183793176, 0.013158234181227508, -0.36769739848872024, -0.012435308761066861, 0.15622824740906557, 0.08963899597249649, -0.12763279397040606, -0.105060333179103, 0.031338963036735855, -5.592559596568291E-33, -0.08492125653558308, 0.021519891089863248, 0.1413058288809326, -0.06970105527175798, 0.23527822436557877, -0.11876819486281386, 0.16239505143905128, -0.05641336007802575, -0.2090090633266502, -0.012973575542370478, 0.044266628170454944, 0.2296330160288899, -0.08180218900519388, 0.15241724307890292, 0.018307227227422927, -0.23859847888902383, -0.12019076612260607, 0.17263643829910844, -0.29528788247801085, 0.2311188226772679, -0.04339067775894095, 0.09818389239134612, 0.29979222916342596, 0.20015300120468493, -0.19941079637242687, 0.0422749580056579, 0.13008083141822782, 0.06599299851115104, -0.02944356058206823, 0.06159133008784718, 0.12860790598723623, -0.217564412082235, -0.29769796629746753, 0.2072931550167225, -0.039927097934263724, -0.16103532737879842, -5.763223463738406E-4, 0.08613508339557382, -0.029580490456687078, 0.31566353156058874, -0.3112833621325316, -0.12273407843032921, -0.021658875600055413, 0.07199256722297934, 0.020195249123153864, 0.1675224538754534, 0.00982760976034182, 0.0015911197772732488, -0.0872023508504585, 0.09855553383628528, -0.28344167796549974, 0.032494793784011294, 0.19086771720537432, 0.2726810232356743, -0.014135220743439815, -0.09151230000511364, 0.07435875573988866, 0.1391828033245272, -0.005937623101528044, -0.04042128069947163, -0.38360074576404357, -0.2696821232912717, -0.01875155764045539, -0.1341144671594655, -0.013109656395735565, 0.25460497434768414, -0.17093491954384027, -0.2815994162250448, 0.027773848907263192, -0.02799159819605174, 0.3456143557473465, 0.11909120961057919, 0.14110397354320245, 0.058519569915477875, 0.23760243891565888, -0.04456010702307577, 0.09937295876443386, 0.08445113269543206, 0.1349145299927504, -0.04076859655065669, 7.234037060428549E-4, -0.11520864524775082, 0.030827554908615572, 0.2200507293972704, -0.12916956069292845, -0.06715465833743413, 0.008487931004276982, -0.02231693047064322, 0.08045511078779344, 0.06686973882218201, -0.17252152923632552, -0.17759517704447111, 0.25538887442262087, 0.27751266963228033, -0.08162619504663679, 1.7936670206630756E-33, 0.33949027334650356, -0.18628383986651897, -0.12484222002051494, -0.09455436992424505, -0.2069491127298938, -0.09415318775508139, 0.001008051344090038, -0.1297189244241626, 0.2997700485090415, -0.09048266639864003, 0.1947890546310831, -0.052057457742867644, 0.02602089720743674, 0.20998588245775965, -0.228895276233002, -0.03683098253828508, -0.16309131098980154, 0.03288885933795461, -0.07199719810375461, 0.15544106900967933, 0.15716541944830506, -0.018054682416496454, -0.22044915043645436, 0.004207856039068213, 0.23954231457577813, 0.04005545971018297, 0.12286582713325818, -0.15534157871648116, -0.057678525922475035, 0.27012293923784186, -0.06509945507126826, 0.11061283566609577, -0.022016170814081474, -0.24471760817148067, 0.16918972431233636, 0.16024491715210457, 0.07655179162544233, -0.16699315807609647, -0.07123141777184275, 0.35527231068246895, 0.019461104577338253, -0.07102487039648825, 0.3637502175514345, 0.09659851494210737, 0.1425479863666826, -0.11086129221237367, -0.3145299866381619, 0.18045678638197757, -0.12802816047850582, 0.13297520074303504, -0.12663246408380843, -0.23718288816787578, -0.13578304482830894, -0.017321328253105835, -0.10607474821585196, -0.19548147716731937, -0.2262026408204326, 0.04662497900426388, -0.3150601729198738, -0.16571148384914355, -0.06818639158478214, 0.03136747978903629, 0.015759232264288044, 0.01217582435519607, -0.00830034201067907, -0.04159838933911589, -0.15194740601711804, -0.3818357850390452, -0.07650208328333166, -0.30623842982782257, 0.1946239471435547, -0.30607473670884416, -0.14815953580869567, 7.949236228510186E-4, 0.3659968727992641, -0.1859620443234841, 0.024258983011047047, 0.15440668455428547, -0.06793527101614961, 0.2765187357586843, 0.0701396730211046, 0.48601000424888396, -0.12390261405596027, -0.027826997300575453, -0.022188220862989074, 0.04843910686947681, 0.1577701093973937, -0.31880603979031247, -0.06326616155328574, -0.10770557189567222, 0.09492709225095394, 0.02587335618833701, -0.3988312678756537, 0.17083848102225196, 0.13069325478540528, -1.0012789386093101E-7, -0.16023357535057045, 0.004903178041179975, -0.0013951671275275726, 0.36605343912486676, 0.03301762968853668, -0.01891451791204788, -0.22790955945297522, -0.21769752567289052, -0.12815191900288617, -0.18981903287823554, 0.21839432138949633, 0.2091838072433516, 0.1208402546191657, 0.11579271399036602, -0.03996479745816301, -0.19309470402421774, 0.12779581024208003, -0.04373201934827699, 0.07121395864696414, 0.23197795160942608, -0.01089637381611047, -0.1849992029644825, 0.2548091552323765, -0.04238835591132994, -0.03480189500583543, 0.039791542243350436, 0.056583410094457644, -0.2796293737159835, 0.27518803864303565, -0.15707958655224907, -0.3430924026502503, -0.008026092899618325, 0.16025451487965053, 0.34848971395856804, 0.11229040211549511, 0.01638909482776567, 0.0758457869567253, -0.10639242110428987, -0.11947987927123904, -0.0495153688998134, 0.024032148774023408, 0.0579118941117216, -0.15203032099331418, -0.12565323324115188, -0.19190758349442924, -0.028997428189204248, 0.01089507282746059, -0.02558891426909853, 0.09421204437536222, 0.2936093319655844, -0.04587233256272696, -0.026037896327950335, 0.09035326233478608, 0.06281227821967116, 0.10881530039909261, 0.018269271693295903, -0.17585129842714028, 0.09704437513870222, -0.15537880775001314, 0.04010882852943959, 0.2194263630512136, 0.22234552215646813, -0.19030070939549693, -0.251560820473565},
      {0.1921641691164537, 0.08079600266434929, 0.13680082915181463, 0.3808123135769909, -0.19382243637334218, -0.19065659010613506, 0.11388057635419747, -0.22716160922903905, 0.3606670332903212, 0.22219416583803567, 0.09509253230961887, -0.015805036506869576, -0.3402458894997835, 0.021897679364139385, -0.2213544948026538, -0.07545201082459906, -0.07484275092032146, 0.12612736597657204, 0.05539037680930712, -0.050259484676644206, -0.24384581636298786, -0.057025386867198075, 0.059649950824677944, 0.20128486694937403, -0.30715344566851854, -0.07791607623750513, -0.5909183502874591, 0.0588286936452443, 0.2134170156310905, -0.29464571372690523, -0.25633172813633626, 7.005681876431812E-4, 0.21844510666348718, -0.07683902216905897, -0.17383546856316653, 0.03236813857008449, 0.30696156100285327, -0.18265176318924536, 0.19468073974448172, 0.029829432087188416, 0.4085986021567475, 0.026157640132375738, 0.2703654992140152, -0.17606349848210812, -0.13350358351387762, 0.1641320126681504, -0.38350508141924033, 0.03731769528663294, 0.04746644884686579, -0.01841051055287773, -0.1282064929943193, -0.12039647314866836, -0.17269573690877718, 0.12128113514997742, 0.04221267264802009, 0.1688477535816756, 0.15097783903845333, -0.03330016110769727, 0.07275979195467451, -0.08695044961165298, 0.43535430915653706, 0.08114507218653505, 0.03855528817935423, 0.039512079346671024, -0.21851812573996457, -0.05449054051529278, -0.2860679301348599, 0.10353169962763786, 0.27261256104843185, 0.2541753070280803, 0.18117636484517294, 0.206051343543963, -0.441198634872721, 0.14459978230297565, -0.11706244585696947, 0.05567343791269443, 0.01605576966804537, 0.25495271799577907, 0.11468543721870943, -0.15705150543627414, -0.051519830033860424, 0.053113189271905205, -0.19169124402105808, 0.0877886054275388, 0.1161536114205691, 0.029152597427706827, -0.10769639947366985, 0.2944049217145551, -0.6126992844722488, -0.23394113616086543, 7.677897810935974E-4, -0.07660180592740123, 0.17516113076867026, -0.2592115318402648, -0.3538065722042864, 0.051940636413002554, 0.031921034678816795, -0.005489388480782509, -0.35842893340370874, -0.2950545840642669, -0.14400639029389078, 0.1166256559504704, 0.022749944082037968, 0.12171945974908092, -0.05760099078443917, 0.017636666618107647, -0.4504519121890718, -0.16612831325354901, 0.2706711610609835, -0.07936392428184097, -0.10298933969302611, -0.010834405791353096, 0.14103261957114394, 0.5771338734775782, -0.44357162375341763, -0.047025234904140234, -0.4557601057670333, -0.13581317095932635, 0.10815615291622552, 0.3056849361481992, -0.24173471458594908, 0.2626931459050287, 0.10959957976063545, -0.2519364765083248, 0.4190190321850506, -0.25031959553333843, 0.05586026329547167, 3.859444198362813E-33, 0.25884159400381823, -0.4573481419039043, 0.22974380596794866, -0.28927419370632956, 0.427463368258693, -0.1963649970394644, -0.37752285066314717, -0.03465722844173962, -0.10748965648764913, 0.09835847856646235, -0.27027800950137054, -0.4624226272783496, 0.04528128296475519, 0.14224200450222602, 0.16409470733593812, -0.07446939718316901, -0.05067559738050808, -0.07065100002695214, -0.07207549164410341, -0.1046594020656564, -0.15139068239791828, -0.10845110277560624, -0.1718518684872172, -0.2097937474873933, 0.33294273125515744, -0.0944693015719002, -0.3645597127350894, -0.3378103039312092, -0.19777632420035926, 0.09943941125476902, -0.01871465544470332, -0.16621506099843167, -0.1459322708912871, 0.07924407487735152, -0.21183303692801433, -0.0320959146219221, 0.6566779715093699, -0.4520047498358922, -0.23856337029825558, -0.03476325867020271, -0.06740392465144396, -0.1113736422055147, -0.1610109263353727, 0.04102951618419452, -0.09222611657936465, -0.019562956623055718, 0.08473319187760353, -0.08514688688923013, -0.02190954526039687, 0.2703822580250827, 0.05431547898545184, 6.879176944494247E-4, 0.023425507951866497, -0.19363391750746153, -0.3083013514564796, 0.15325975240292875, 0.24140862934291363, 0.1528078822249716, -0.29152312807061453, 0.26650139613246376, 0.08632483257150109, -0.19341684606942264, -0.3272503306242553, 0.004153697666796771, 0.0897689000280066, -0.016191024587235668, 0.01965921956368468, 0.05685840724882754, -0.07284851182802496, 0.39161591756750236, 0.010400531051511114, -0.23577759076248517, -0.3388830859383399, -0.21167677361518145, -0.13739815959706903, -0.024802254978567362, -0.16643112974072044, -0.14636587609790944, -0.07911960120228204, 0.05655080905522813, 0.38140499739992345, -0.046442891979082065, -0.07843308353965933, -0.18072446588088165, 0.13984332436865027, -0.04666502350433306, 0.3725144686177373, -0.02753081697631966, 0.05499092811210589, 0.10074009924111041, 0.23707354695282198, 0.1744583947584033, 0.2597133601931008, -0.12351344470781359, 0.08750636824830012, -1.3744941768518128E-32, -0.2361045806584033, -0.31276941231705924, 0.182286517821591, 0.024696761403571476, -0.09616642885587433, 0.21024021781472998, -0.3737089028581977, -0.16230792984027753, -0.31473973054777493, -0.22341552918607538, -0.13144378457218409, 0.2942508233880455, 0.12860805439678105, 0.04469859041273594, 0.32271880664947356, -0.2243031973696568, 0.07475903427059, 0.23146619901738383, 0.2014351055364717, -0.12093431392515247, -0.030750604685057293, 0.0370041559534994, -0.03924920088188215, 0.13698795195457272, 0.18828719524158674, -0.057638592002066696, 0.10751972482963042, 0.0637720491821793, -0.17753274806521155, 0.05174202438105236, -0.16521789523010905, 0.12613973656499927, 0.027027480219575493, -0.20466751232743263, 0.0018991524014960635, -0.009520571678876877, -0.4514366334134882, -0.034142354926602406, -0.034928413700651036, 0.027466952123425224, -0.025180797727609224, 0.08558000158518553, 0.058655324138023636, 0.03608207599344579, 0.1196463565680791, -0.03114213142544031, -0.23186935729939828, 0.528253770518032, -0.2439384777098894, 0.1014734786003828, -0.20280977347019044, -0.08975616901774298, 0.21889961819926446, 0.14688592615791343, 0.14480322430079634, 0.07577332439409061, -0.25820206643336197, -0.15324300866235385, 0.39323021860962565, -0.009601206158880483, -0.022229569032788277, -0.05790420181371949, 0.02391796148466793, 0.24483379095115446, 0.15504012773321432, -0.07017764288254759, -0.1985047049820423, -0.21381596526639027, -0.3917227177457376, -0.10770671340552243, 0.14627113769000227, 0.2179849502545866, -0.0038092673163522372, 0.29045790213752876, 0.019383665682239967, 0.22476984827186575, -0.05089413179931315, 0.1466494770720601, 0.005456210198727521, 0.044263838536360046, -0.33164915637197817, 0.140386297409846, 0.17486927675252611, 0.022399176420135933, -0.36313303153623233, -0.08357061445713043, -0.2953516761349006, 0.44139494509859517, 0.025554012041538954, 0.14498902992768722, 0.024804883869364858, 0.16044584636322476, -0.15859426828947934, 0.09094431352886287, -0.024917385540902615, -9.983947922943447E-8, -0.11854012385645712, 0.03191555376079949, 0.02407807060940699, -0.14439390366896987, -0.07594323124397885, 0.18399987268176946, 0.21507897465066475, 0.10805854555854405, 0.042610241946848953, -0.11817562444643541, 0.13570536668835717, 0.10433655807917769, 0.10474889183586295, 0.29032437435605307, 0.022031250833110375, 0.2313062088056044, -0.12480087129568512, -0.00828019402582537, -0.07752098439430649, 0.6140090376138687, -0.03285753024234013, -0.21505030159923164, 0.16498317281630906, -0.019605214538222008, -0.2507365843789144, -0.17211457121778617, -0.12865091115236282, 0.4014053439552134, 0.11260145293040709, 0.09564669396389615, 0.008134444413537329, -0.04139005761085586, 0.37007009017873893, 0.30049574946645985, 0.2186949127777056, 0.16080087745054203, 0.07750089263374155, 0.10385130366987803, 0.09574213302270933, -0.12728812850334428, 0.14075690605254335, -0.16056491459973835, -0.16122355498373508, -0.006691618399186568, -0.03644740395247936, 0.16278745758939872, 0.1447736956179142, 0.41040947135876527, -0.20765126060525124, -0.19637429371306842, -0.22193472214381804, -0.21008357591927052, 0.2710231684825637, 0.155487628526647, -0.1394860910421068, -0.06822795133021745, 0.0688506157814779, -0.11302979734980247, 0.2258911349556663, 0.0883118746463548, 0.1516905025663701, 0.20017180684953928, 0.19416243836961009, 0.3457708368924531}
  };

  @Test
  public void testSimilarityCenter() {
    FlinkVectorType[] results = new FlinkVectorType[VECTORS.length];
    for (int i = 0; i < results.length; i++) {
      results[i] = VectorFunctions.DOUBLE_TO_VECTOR.eval(VECTORS[i]);
    }
    double[][] similarities = new double[results.length][];
    double[][] euclidDist = new double[results.length][];
    for (int i = 0; i < results.length; i++) {
      similarities[i] = new double[i];
      euclidDist[i] = new double[i];
      for (int j = 0; j < i; j++) {
        similarities[i][j] = VectorFunctions.COSINE_SIMILARITY.eval(results[i], results[j]);
        euclidDist[i][j] = VectorFunctions.EUCLIDEAN_DISTANCE.eval(results[i], results[j]);
//        System.out.println(i + ":" + j + " = "  + euclidDist[i][j]);
      }
    }
    assertEquals(similarities[1][0],0.9026232695106989, 0.0000001);
    assertEquals(similarities[2][0],0.030318433205579004, 0.0000001);
    assertEquals(similarities[2][1],0.018290961759306813, 0.0000001);
    assertEquals(VectorFunctions.COSINE_SIMILARITY.eval(results[0], results[1]),similarities[1][0], 0.0000001);
    assertEquals(euclidDist[1][0],1.5302227431135083, 0.0000001);
    assertEquals(euclidDist[2][0],5.257065238717278, 0.0000001);
    assertEquals(euclidDist[2][1],5.120142257793784, 0.0000001);
    assertEquals(VectorFunctions.EUCLIDEAN_DISTANCE.eval(results[0], results[1]),euclidDist[1][0], 0.0000001);


    CenterAccumulator acc = VectorFunctions.CENTER.createAccumulator();
    for (FlinkVectorType result : results) {
      VectorFunctions.CENTER.accumulate(acc, result);
    }
    VectorFunctions.CENTER.retract(acc, results[2]);
    FlinkVectorType center = VectorFunctions.CENTER.getValue(acc);
    assertEquals(VectorFunctions.COSINE_SIMILARITY.eval(results[0],center),0.9772371038888683, 0.0000001);
    assertEquals(VectorFunctions.COSINE_SIMILARITY.eval(results[1],center),0.9733930025393428, 0.0000001);

    CenterAccumulator combined = VectorFunctions.CENTER.createAccumulator();
    List<CenterAccumulator> individuals = Stream.of(results[0], results[1])
        .map(vec -> {
          CenterAccumulator individual = VectorFunctions.CENTER.createAccumulator();
          VectorFunctions.CENTER.accumulate(individual,vec);
          return individual;
        }).collect(Collectors.toList());
    VectorFunctions.CENTER.merge(combined, individuals);
    assertEquals(VectorFunctions.COSINE_SIMILARITY.eval(
        VectorFunctions.CENTER.getValue(combined),center),1.0, 0.0000001);
  }


}
