=== CombinedStream
ID:     combinedstream$1
Type:   stream
Stage:  streams
Inputs: customer$2, orders$2
Primary Key: __pk$0
Timestamp  : rowtime
Schema:
 - customerid: BIGINT NOT NULL
 - rowtime: TIMESTAMP_WITH_LOCAL_TIME_ZONE(3) NOT NULL
 - __pk$0: CHAR(36) CHARACTER SET "UTF-16LE" NOT NULL
Plan:
LogicalUnion(all=[true])
  LogicalProject(customerid=[$3], rowtime=[$4], __pk$0=[$0])
    LogicalTableScan(table=[[orders$2]])
  LogicalProject(customerid=[$2], rowtime=[$6], __pk$0=[$0])
    LogicalTableScan(table=[[customer$2]])

=== Customer
ID:     customer$2
Type:   stream
Stage:  streams
Primary Key: _uuid
Timestamp  : timestamp
Schema:
 - _uuid: CHAR(36) CHARACTER SET "UTF-16LE" NOT NULL
 - _ingest_time: TIMESTAMP_WITH_LOCAL_TIME_ZONE(3) NOT NULL
 - customerid: BIGINT NOT NULL
 - email: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - name: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - lastUpdated: BIGINT NOT NULL
 - timestamp: TIMESTAMP_WITH_LOCAL_TIME_ZONE(3) NOT NULL
Plan:
LogicalProject(_uuid=[$0], _ingest_time=[$1], customerid=[$2], email=[$3], name=[$4], lastUpdated=[$5], timestamp=[epochToTimestamp($5)]) hints[WatermarkHint options:[6]]
  LogicalTableScan(table=[[customer$1]])

=== Orders
ID:     orders$2
Type:   stream
Stage:  streams
Primary Key: _uuid
Timestamp  : time
Schema:
 - _uuid: CHAR(36) CHARACTER SET "UTF-16LE" NOT NULL
 - _ingest_time: TIMESTAMP_WITH_LOCAL_TIME_ZONE(3) NOT NULL
 - id: BIGINT NOT NULL
 - customerid: BIGINT NOT NULL
 - time: TIMESTAMP_WITH_LOCAL_TIME_ZONE(3) NOT NULL
 - entries: RecordType(INTEGER NOT NULL _idx, BIGINT NOT NULL productid, BIGINT NOT NULL quantity, DOUBLE NOT NULL unit_price, DOUBLE discount) NOT NULL ARRAY NOT NULL
Plan:
LogicalTableScan(table=[[orders$1]], hints=[[[WatermarkHint inheritPath:[] options:[4]]]]) hints[WatermarkHint options:[4]]

=== StreamCount
ID:     streamcount$1
Type:   stream
Stage:  streams
Inputs: combinedstream$1
Primary Key: day
Timestamp  : day
Schema:
 - day: TIMESTAMP_WITH_LOCAL_TIME_ZONE(3) NOT NULL
 - num: BIGINT NOT NULL
Plan:
LogicalAggregate(group=[{0}], num=[COUNT()]) hints[TumbleAggregationHint options:[0, FUNCTION, 2, 86400000, 0]]
  LogicalProject(day=[endOfDay($1)], __pk$0=[$2], rowtime=[$1])
    LogicalTableScan(table=[[combinedstream$1]])

