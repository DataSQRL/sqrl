=== Customer
ID:     customer$2
Type:   stream
Stage:  streams
Primary Key: _uuid
Timestamp  : timestamp
Schema:
 - _uuid: CHAR(36) CHARACTER SET "UTF-16LE" NOT NULL
 - _ingest_time: TIMESTAMP_WITH_LOCAL_TIME_ZONE(3) NOT NULL
 - customerid: BIGINT NOT NULL
 - email: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - name: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - lastUpdated: BIGINT NOT NULL
 - timestamp: TIMESTAMP_WITH_LOCAL_TIME_ZONE(3) NOT NULL
Plan:
LogicalProject(_uuid=[$0], _ingest_time=[$1], customerid=[$2], email=[$3], name=[$4], lastUpdated=[$5], timestamp=[epochToTimestamp($5)]) hints[WatermarkHint options:[6]]
  LogicalTableScan(table=[[customer$1]])

=== Customer
ID:     customer$3
Type:   state
Stage:  streams
Inputs: customer$2
Primary Key: customerid
Timestamp  : timestamp
Schema:
 - _uuid: CHAR(36) CHARACTER SET "UTF-16LE" NOT NULL
 - _ingest_time: TIMESTAMP_WITH_LOCAL_TIME_ZONE(3) NOT NULL
 - customerid: BIGINT NOT NULL
 - email: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - name: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - lastUpdated: BIGINT NOT NULL
 - timestamp: TIMESTAMP_WITH_LOCAL_TIME_ZONE(3) NOT NULL
Post Processors:
 - topN: partition=customerid limit=1 sort=#6: timestamp TIMESTAMP_WITH_LOCAL_TIME_ZONE(3) DESC-nulls-last 
Plan:
LogicalTableScan(table=[[customer$2]])

=== OrderCustomer
ID:     ordercustomer$1
Type:   state
Stage:  database
Inputs: customer$3, orders$2
Primary Key: _uuid0
Timestamp  : __timestamp0
Schema:
 - id: BIGINT NOT NULL
 - name: VARCHAR(2147483647) CHARACTER SET "UTF-16LE"
 - _uuid0: CHAR(36) CHARACTER SET "UTF-16LE" NOT NULL
 - __timestamp0: TIMESTAMP_WITH_LOCAL_TIME_ZONE(3)
Plan:
LogicalProject(id=[$2], name=[$10], _uuid0=[$0], __timestamp0=[CASE(<($4, $12), $12, $4)])
  LogicalJoin(condition=[=($3, $8)], joinType=[left]) hints[JoinCostHint options:[STREAM, VERSIONED_STATE, 1, RIGHT]]
    LogicalTableScan(table=[[orders$2]])
    LogicalTableScan(table=[[customer$3]])

=== OrderCustomer2
ID:     ordercustomer2$1
Type:   stream
Stage:  streams
Inputs: customer$3, orders$2
Primary Key: _uuid0
Timestamp  : _time
Schema:
 - id: BIGINT NOT NULL
 - name: VARCHAR(2147483647) CHARACTER SET "UTF-16LE"
 - _uuid0: CHAR(36) CHARACTER SET "UTF-16LE" NOT NULL
 - _time: TIMESTAMP_WITH_LOCAL_TIME_ZONE(3) NOT NULL
Plan:
LogicalProject(id=[$2], name=[$10], _uuid0=[$0], _time=[$4])
  LogicalJoin(condition=[=($3, $8)], joinType=[left]) hints[TemporalJoinHint options:[4, 6, 2]]
    LogicalTableScan(table=[[orders$2]])
    LogicalFilter(condition=[=($7, 1)]) hints[DedupHint]
      LogicalProject(_uuid=[$0], _ingest_time=[$1], customerid=[$2], email=[$3], name=[$4], lastUpdated=[$5], timestamp=[$6], _rownum=[ROW_NUMBER() OVER (PARTITION BY $2 ORDER BY $6 DESC NULLS LAST)])
        LogicalTableScan(table=[[customer$3]])

=== OrderCustomer3
ID:     ordercustomer3$1
Type:   state
Stage:  database
Inputs: customer$3, orders$2
Primary Key: _uuid0
Timestamp  : __timestamp0
Schema:
 - id: BIGINT NOT NULL
 - name: VARCHAR(2147483647) CHARACTER SET "UTF-16LE"
 - _uuid0: CHAR(36) CHARACTER SET "UTF-16LE" NOT NULL
 - __timestamp0: TIMESTAMP_WITH_LOCAL_TIME_ZONE(3)
Plan:
LogicalProject(id=[$2], name=[$10], _uuid0=[$0], __timestamp0=[CASE(<($4, $12), $12, $4)])
  LogicalJoin(condition=[=($3, $8)], joinType=[left]) hints[JoinCostHint options:[STREAM, VERSIONED_STATE, 1, RIGHT]]
    LogicalTableScan(table=[[orders$2]])
    LogicalTableScan(table=[[customer$3]])

=== OrderCustomer4
ID:     ordercustomer4$1
Type:   state
Stage:  database
Inputs: customer$3, orders$2
Primary Key: _uuid0
Timestamp  : __timestamp0
Schema:
 - id: BIGINT NOT NULL
 - name: VARCHAR(2147483647) CHARACTER SET "UTF-16LE"
 - _uuid0: CHAR(36) CHARACTER SET "UTF-16LE" NOT NULL
 - __timestamp0: TIMESTAMP_WITH_LOCAL_TIME_ZONE(3)
Plan:
LogicalProject(id=[$2], name=[$10], _uuid0=[$0], __timestamp0=[CASE(<($4, $12), $12, $4)])
  LogicalJoin(condition=[=($3, $8)], joinType=[left]) hints[JoinCostHint options:[STREAM, VERSIONED_STATE, 1, RIGHT]]
    LogicalTableScan(table=[[orders$2]])
    LogicalTableScan(table=[[customer$3]])

=== Orders
ID:     orders$2
Type:   stream
Stage:  streams
Primary Key: _uuid
Timestamp  : time
Schema:
 - _uuid: CHAR(36) CHARACTER SET "UTF-16LE" NOT NULL
 - _ingest_time: TIMESTAMP_WITH_LOCAL_TIME_ZONE(3) NOT NULL
 - id: BIGINT NOT NULL
 - customerid: BIGINT NOT NULL
 - time: TIMESTAMP_WITH_LOCAL_TIME_ZONE(3) NOT NULL
 - entries: RecordType(INTEGER NOT NULL _idx, BIGINT NOT NULL productid, BIGINT NOT NULL quantity, DOUBLE NOT NULL unit_price, DOUBLE discount) NOT NULL ARRAY NOT NULL
Plan:
LogicalTableScan(table=[[orders$1]], hints=[[[WatermarkHint inheritPath:[] options:[4]]]]) hints[WatermarkHint options:[4]]

