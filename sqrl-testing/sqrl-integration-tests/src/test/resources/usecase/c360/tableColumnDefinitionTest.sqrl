IMPORT time.*;
IMPORT ecommerce-data.Customer TIMESTAMP timestamp;
IMPORT ecommerce-data.Orders TIMESTAMP _ingest_time;
IMPORT ecommerce-data.Product TIMESTAMP _ingest_time;
Customer.timestamp := epochToTimestamp(lastUpdated);
Customer := DISTINCT Customer ON customerid ORDER BY timestamp DESC;
Orders.col1 := (id + customerid)/2;
Orders.entries.discount2 := COALESCE(discount,0.0);
EntryPrice := SELECT e.quantity * e.unit_price - e.discount as price FROM Orders.entries e;
OrderCustomer := SELECT o.id, c.name, o.customerid, o.col1, e.discount2 FROM Orders o JOIN o.entries e JOIN Customer c on o.customerid = c.customerid;
