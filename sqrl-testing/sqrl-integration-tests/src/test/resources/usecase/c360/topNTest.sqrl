IMPORT time.*;
IMPORT ecommerce-data.Customer TIMESTAMP updateTime;
IMPORT ecommerce-data.Orders TIMESTAMP time;
IMPORT ecommerce-data.Product TIMESTAMP _ingest_time;
Customer.updateTime := epochToTimestamp(lastUpdated);
CustomerDistinct := DISTINCT Customer ON customerid ORDER BY updateTime DESC;
CustomerDistinct.recentOrders := SELECT o.id, o.time  FROM @ JOIN Orders o WHERE @.customerid = o.customerid ORDER BY o.time DESC LIMIT 10;
CustomerId := SELECT DISTINCT customerid FROM Customer;
CustomerOrders := SELECT o.id, c.customerid FROM CustomerId c JOIN Orders o ON o.customerid = c.customerid;
CustomerDistinct.distinctOrders := SELECT DISTINCT o.id FROM @ JOIN Orders o WHERE @.customerid = o.customerid ORDER BY o.id DESC LIMIT 10;
CustomerDistinct.distinctOrdersTime := SELECT DISTINCT o.id, o.time  FROM @ JOIN Orders o WHERE @.customerid = o.customerid ORDER BY o.time  DESC LIMIT 10;
Orders := DISTINCT Orders ON id ORDER BY time DESC;
