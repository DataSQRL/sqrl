IMPORT ecommerceTs.Customer AS CustomerStream;
Customer := DISTINCT CustomerStream ON customerid ORDER BY `timestamp` DESC;
/*+ EXEC(streams) */ toJsonTable := SELECT customerid, toJson('{"a": 1}') AS obj FROM Customer;
/*+ EXEC(streams) */ jsonArrayTable := SELECT customerid, jsonArray(customerid) AS obj FROM Customer;
/*+ EXEC(streams) */ jsonObjectAggTable := SELECT jsonObjectAgg('key', name) AS agg FROM Customer GROUP BY name;
/*+ EXEC(streams) */ jsonToStringTable := SELECT customerid, jsonToString(toJson('{"a": 1}')) AS obj FROM Customer;
/*+ EXEC(streams) */ jsonExtractTable := SELECT customerid, jsonExtract(toJson('{"a": "hello"}'), CAST('$.a' AS varchar), CAST('default' AS varchar)) AS obj FROM Customer;
/*+ EXEC(streams) */ jsonQueryTable := SELECT customerid, jsonQuery(toJson('{"a": {"b": 1}}'), '$.a') AS obj FROM Customer;
/*+ EXEC(streams) */ jsonExistsTable := SELECT customerid, jsonExists(toJson('{"a": true}'), '$.a') AS obj FROM Customer;
/*+ EXEC(streams) */ jsonConcatTable := SELECT customerid, jsonConcat(toJson('{"a": true}'), toJson('{"a": false}')) AS obj FROM Customer;
/*+ EXEC(streams) */ jsonArrayAggTable := SELECT jsonArrayAgg(name) AS agg FROM Customer GROUP BY name;
/*+ EXEC(streams) */ ObjComplex := SELECT customerid, jsonObject(concat('application#',CAST(name AS VARCHAR)), customerid) AS obj FROM Customer;
