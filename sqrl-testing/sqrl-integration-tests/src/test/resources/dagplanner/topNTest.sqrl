IMPORT time.*;
IMPORT ecommerceTs.Customer;
IMPORT ecommerceTs.Orders;
IMPORT ecommerceTs.Product;
CustomerDistinct := DISTINCT Customer ON customerid ORDER BY timestamp DESC;
CustomerDistinct.recentOrders := SELECT o.id, o.time FROM @ TEMPORAL JOIN Orders o WHERE @.customerid = o.customerid ORDER BY o.time DESC LIMIT 10;
CustomerId := SELECT DISTINCT customerid FROM Customer;
CustomerOrders := SELECT o.id, c.customerid FROM CustomerId c JOIN Orders o ON o.customerid = c.customerid;
CustomerDistinct.distinctOrders := SELECT DISTINCT o.id FROM @ JOIN Orders o WHERE @.customerid = o.customerid ORDER BY o.id DESC LIMIT 10;
CustomerDistinct.distinctOrdersTime := SELECT DISTINCT o.id, o.time  FROM @ JOIN Orders o WHERE @.customerid = o.customerid ORDER BY o.time  DESC LIMIT 10;
Orders := DISTINCT Orders ON id ORDER BY time DESC;
