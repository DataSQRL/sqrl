IMPORT ecommerceTs.Customer AS CustomerStream;
Customer := DISTINCT CustomerStream ON customerid ORDER BY `timestamp` DESC;
/*+ EXEC(database) */ toJsonTable := SELECT toJson('{"a": 1}') AS obj FROM Customer;
/*+ EXEC(database) */ jsonArrayTable := SELECT jsonArray(customerid) AS obj FROM Customer;
/*+ EXEC(database) */ jsonObjectAggTable := SELECT jsonObjectAgg('key', name) AS agg FROM Customer GROUP BY name;
/*+ EXEC(database) */ jsonToStringTable := SELECT jsonToString(toJson('{"a": 1}')) AS obj FROM Customer;
/*+ EXEC(database) */ jsonExtractTable := SELECT jsonExtract(toJson('{"a": "hello"}'), CAST('$.a' AS varchar), CAST('default' AS varchar)) AS obj FROM Customer;
/*+ EXEC(database) */ jsonQueryTable := SELECT jsonQuery(toJson('{"a": {"b": 1}}'), '$.a') AS obj FROM Customer;
/*+ EXEC(database) */ jsonExistsTable := SELECT jsonExists(toJson('{"a": true}'), '$.a') AS obj FROM Customer;
/*+ EXEC(database) */ jsonConcatTable := SELECT jsonConcat(toJson('{"a": true}'), toJson('{"a": false}')) AS obj FROM Customer;
/*+ EXEC(database) */ jsonArrayAggTable := SELECT jsonArrayAgg(name) AS agg FROM Customer GROUP BY name;
/*+ EXEC(database) */ ObjComplex := SELECT jsonObject(concat('application#',CAST(name AS VARCHAR)), customerid) AS obj FROM Customer;
