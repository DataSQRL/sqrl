>>>database
CREATE INDEX IF NOT EXISTS "orders$6_btree_c3c5" ON "orders$6" USING btree ("customerid","timestamp");
CREATE INDEX IF NOT EXISTS "orders$6_hash_c2" ON "orders$6" USING hash ("id");
CREATE INDEX IF NOT EXISTS "products$11_hash_c3" ON "products$11" USING hash ("name");
CREATE TABLE IF NOT EXISTS "customers$13" ("id" bigint not null,"timestamp" timestamp(9) with time zone not null , PRIMARY KEY ("id"));
CREATE TABLE IF NOT EXISTS "items$7" ("_uuid" character varying not null,"_idx" integer not null,"productid" bigint not null,"quantity" bigint not null,"unit_price" double precision not null,"discount" double precision,"discount$0" double precision not null,"total" double precision not null,"timestamp" timestamp(9) with time zone not null , PRIMARY KEY ("_uuid","_idx"));
CREATE TABLE IF NOT EXISTS "orders$6" ("_uuid" character varying not null,"_ingest_time" timestamp(9) with time zone not null,"id" bigint not null,"customerid" bigint not null,"time" bigint not null,"timestamp" timestamp(9) with time zone not null , PRIMARY KEY ("_uuid"));
CREATE TABLE IF NOT EXISTS "past_purchases$17" ("__id$pk$1" bigint not null,"productid" bigint not null,"num_orders" bigint not null,"total_quantity" bigint not null,"timestamp" timestamp(9) with time zone not null , PRIMARY KEY ("__id$pk$1","productid"));
CREATE TABLE IF NOT EXISTS "products$11" ("id" bigint not null,"_uuid" character varying not null,"_ingest_time" timestamp(9) with time zone not null,"name" character varying not null,"sizing" character varying not null,"weight_in_gram" bigint not null,"type" character varying not null,"category" character varying not null,"usda_id" bigint not null,"updated" timestamp(9) with time zone not null , PRIMARY KEY ("id"));
CREATE TABLE IF NOT EXISTS "spending_by_month$15" ("__id$pk$1" bigint not null,"month" timestamp(9) with time zone not null,"total_spend" double precision not null,"total_savings" double precision not null , PRIMARY KEY ("__id$pk$1","month"));
CREATE TABLE IF NOT EXISTS "totals$9" ("___uuid$pk$1" character varying not null,"price" double precision not null,"savings" double precision not null,"timestamp" timestamp(9) with time zone not null , PRIMARY KEY ("___uuid$pk$1"));
CREATE TABLE IF NOT EXISTS "volume_by_day$19" ("__id$pk$1" bigint not null,"day" timestamp(9) with time zone not null,"quantity" bigint not null,"total" double precision not null,"total_weight" bigint not null , PRIMARY KEY ("__id$pk$1","day"));
>>>query-allcustomers
{
  "data" : {
    "Customers" : [ {
      "id" : 1,
      "spending_by_month" : [ {
        "total_spend" : 225.77,
        "total_savings" : 14.73
      }, {
        "total_spend" : 95.53,
        "total_savings" : 1.24
      } ]
    }, {
      "id" : 2,
      "spending_by_month" : [ {
        "total_spend" : 336.64,
        "total_savings" : 50.49
      }, {
        "total_spend" : 139.86,
        "total_savings" : 29.08
      } ]
    }, {
      "id" : 3,
      "spending_by_month" : [ {
        "total_spend" : 20.64,
        "total_savings" : 0
      }, {
        "total_spend" : 53.94,
        "total_savings" : 0
      } ]
    }, {
      "id" : 4,
      "spending_by_month" : [ {
        "total_spend" : 98.75,
        "total_savings" : 7
      }, {
        "total_spend" : 118.5,
        "total_savings" : 18.28
      } ]
    }, {
      "id" : 5,
      "spending_by_month" : [ {
        "total_spend" : 149.08,
        "total_savings" : 4.43
      }, {
        "total_spend" : 105.55,
        "total_savings" : 65.73
      } ]
    }, {
      "id" : 6,
      "spending_by_month" : [ {
        "total_spend" : 172.84,
        "total_savings" : 12.64
      }, {
        "total_spend" : 36.55,
        "total_savings" : 16.87
      } ]
    }, {
      "id" : 7,
      "spending_by_month" : [ {
        "total_spend" : 86.94,
        "total_savings" : 7.94
      }, {
        "total_spend" : 23.83,
        "total_savings" : 0
      } ]
    }, {
      "id" : 8,
      "spending_by_month" : [ {
        "total_spend" : 118.54,
        "total_savings" : 7.26
      }, {
        "total_spend" : 17.59,
        "total_savings" : 5.27
      } ]
    }, {
      "id" : 9,
      "spending_by_month" : [ {
        "total_spend" : 78.83,
        "total_savings" : 5.95
      }, {
        "total_spend" : 94.36,
        "total_savings" : 21.88
      } ]
    }, {
      "id" : 10,
      "spending_by_month" : [ {
        "total_spend" : 104.33,
        "total_savings" : 35.41
      }, {
        "total_spend" : 84.18,
        "total_savings" : 4.24
      } ]
    } ]
  }
}
>>>query-customer
{
  "data" : {
    "Customers" : [ {
      "id" : 10,
      "spending_by_month" : [ {
        "total_spend" : 104.33,
        "total_savings" : 35.41
      }, {
        "total_spend" : 84.18,
        "total_savings" : 4.24
      } ]
    } ]
  }
}
