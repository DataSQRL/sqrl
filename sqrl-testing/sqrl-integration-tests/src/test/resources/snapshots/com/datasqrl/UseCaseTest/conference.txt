>>>pipeline_explain.txt
=== AddInterest
ID:     addinterest$2
Type:   stream
Stage:  streams
Primary Key: _uuid
Timestamp  : event_time
Schema:
 - text: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - userid: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - _uuid: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - event_time: TIMESTAMP_WITH_LOCAL_TIME_ZONE(3) NOT NULL
Plan:
LogicalTableScan(table=[[addinterest$1]], hints=[[[WatermarkHint inheritPath:[] options:[3]]]]) hints[WatermarkHint options:[3]]

=== AddInterest
ID:     addinterest$3
Type:   stream
Stage:  streams
Inputs: addinterest$2, testaddinterest$2
Primary Key: _uuid
Timestamp  : event_time
Schema:
 - _uuid: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - userid: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - text: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - event_time: TIMESTAMP_WITH_LOCAL_TIME_ZONE(3) NOT NULL
 - embedding: RAW('com.datasqrl.vector.FlinkVectorType', 'ADVjb20uZGF0YXNxcmwudmVjdG9yLkZsaW5rVmVjdG9yVHlwZVNlcmlhbGl6ZXJTbmFwc2hvdAAAAAEALWNvbS5kYXRhc3FybC52ZWN0b3IuRmxpbmtWZWN0b3JUeXBlU2VyaWFsaXplcg==')
Plan:
LogicalProject(_uuid=[$0], userid=[$1], text=[$2], event_time=[$3], embedding=[asciiTextTestEmbed($2)])
  LogicalUnion(all=[true])
    LogicalProject(_uuid=[$2], userid=[$1], text=[$0], event_time=[$3])
      LogicalTableScan(table=[[addinterest$2]])
    LogicalTableScan(table=[[testaddinterest$2]])

=== Events
ID:     events$2
Type:   stream
Stage:  streams
Primary Key: url, last_updated
Timestamp  : last_updated
Schema:
 - url: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - date: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - time: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - title: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - abstract: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - location: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - speakers: RecordType(VARCHAR(2147483647) CHARACTER SET "UTF-16LE" name, VARCHAR(2147483647) CHARACTER SET "UTF-16LE" title, VARCHAR(2147483647) CHARACTER SET "UTF-16LE" company) NOT NULL ARRAY NOT NULL
 - last_updated: TIMESTAMP_WITH_LOCAL_TIME_ZONE(3) NOT NULL
 - id: BIGINT NOT NULL
 - full_text: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - embedding: RAW('com.datasqrl.vector.FlinkVectorType', 'ADVjb20uZGF0YXNxcmwudmVjdG9yLkZsaW5rVmVjdG9yVHlwZVNlcmlhbGl6ZXJTbmFwc2hvdAAAAAEALWNvbS5kYXRhc3FybC52ZWN0b3IuRmxpbmtWZWN0b3JUeXBlU2VyaWFsaXplcg==')
 - startTime: VARCHAR(2147483647) CHARACTER SET "UTF-16LE"
 - startTimestamp: TIMESTAMP_WITH_LOCAL_TIME_ZONE(3)
Plan:
LogicalProject(url=[$0], date=[$1], time=[$2], title=[$3], abstract=[$4], location=[$5], speakers=[$6], last_updated=[$7], id=[COALESCE(CAST(REGEXP_EXTRACT($0, '(\d*)$')):BIGINT, 0:BIGINT)], full_text=[CONCAT($3, '\n', $4)], embedding=[asciiTextTestEmbed(CONCAT($3, '\n', $4))], startTime=[CONCAT(TRIM(FLAG(BOTH), ' ', REGEXP_EXTRACT($1, '^[^-]*')), ' ', TRIM(FLAG(BOTH), ' ', REGEXP_EXTRACT($2, '\d\d?:\d\d\s(AM|PM)')))], startTimestamp=[parseTimestamp(CONCAT(CONCAT(TRIM(FLAG(BOTH), ' ', REGEXP_EXTRACT($1, '^[^-]*')), ' ', TRIM(FLAG(BOTH), ' ', REGEXP_EXTRACT($2, '\d\d?:\d\d\s(AM|PM)'))), ' PDT'), 'MMMM d, yyyy h:mm a z')]) hints[WatermarkHint options:[7]]
  LogicalTableScan(table=[[events$1]])

=== Events
ID:     events$3
Type:   state
Stage:  streams
Inputs: events$2
Primary Key: id
Timestamp  : last_updated
Schema:
 - url: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - date: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - time: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - title: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - abstract: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - location: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - speakers: RecordType(VARCHAR(2147483647) CHARACTER SET "UTF-16LE" name, VARCHAR(2147483647) CHARACTER SET "UTF-16LE" title, VARCHAR(2147483647) CHARACTER SET "UTF-16LE" company) NOT NULL ARRAY NOT NULL
 - last_updated: TIMESTAMP_WITH_LOCAL_TIME_ZONE(3) NOT NULL
 - id: BIGINT NOT NULL
 - full_text: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - embedding: RAW('com.datasqrl.vector.FlinkVectorType', 'ADVjb20uZGF0YXNxcmwudmVjdG9yLkZsaW5rVmVjdG9yVHlwZVNlcmlhbGl6ZXJTbmFwc2hvdAAAAAEALWNvbS5kYXRhc3FybC52ZWN0b3IuRmxpbmtWZWN0b3JUeXBlU2VyaWFsaXplcg==')
 - startTime: VARCHAR(2147483647) CHARACTER SET "UTF-16LE"
 - startTimestamp: TIMESTAMP_WITH_LOCAL_TIME_ZONE(3)
Post Processors:
 - topN: partition=id limit=1 sort=#7: last_updated TIMESTAMP_WITH_LOCAL_TIME_ZONE(3) DESC-nulls-last 
Plan:
LogicalTableScan(table=[[events$2]])

=== Likes
ID:     likes$2
Type:   stream
Stage:  streams
Primary Key: _uuid
Timestamp  : event_time
Schema:
 - eventId: BIGINT NOT NULL
 - userid: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - liked: BOOLEAN NOT NULL
 - _uuid: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - event_time: TIMESTAMP_WITH_LOCAL_TIME_ZONE(3) NOT NULL
Plan:
LogicalTableScan(table=[[likes$1]], hints=[[[WatermarkHint inheritPath:[] options:[4]]]]) hints[WatermarkHint options:[4]]

=== Likes
ID:     likes$3
Type:   stream
Stage:  streams
Inputs: likes$2, testlikes$2
Primary Key: _uuid
Timestamp  : event_time
Schema:
 - eventId: BIGINT NOT NULL
 - userid: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - liked: BOOLEAN NOT NULL
 - _uuid: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - event_time: TIMESTAMP_WITH_LOCAL_TIME_ZONE(3) NOT NULL
Plan:
LogicalUnion(all=[true])
  LogicalTableScan(table=[[likes$2]])
  LogicalProject(eventId=[$1], userid=[$2], liked=[$3], _uuid=[$0], event_time=[$4])
    LogicalTableScan(table=[[testlikes$2]])

=== LikeVector
ID:     likevector$1
Type:   stream
Stage:  streams
Inputs: events$3, likes$3
Primary Key: _uuid
Timestamp  : event_time
Schema:
 - userid: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - embedding: RAW('com.datasqrl.vector.FlinkVectorType', 'ADVjb20uZGF0YXNxcmwudmVjdG9yLkZsaW5rVmVjdG9yVHlwZVNlcmlhbGl6ZXJTbmFwc2hvdAAAAAEALWNvbS5kYXRhc3FybC52ZWN0b3IuRmxpbmtWZWN0b3JUeXBlU2VyaWFsaXplcg==')
 - title: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - abstract: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - location: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - event_time: TIMESTAMP_WITH_LOCAL_TIME_ZONE(3) NOT NULL
 - _uuid: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
Plan:
LogicalProject(userid=[$1], embedding=[$15], title=[$8], abstract=[$9], location=[$10], event_time=[$4], _uuid=[$3])
  LogicalJoin(condition=[=($0, $13)], joinType=[inner]) hints[TemporalJoinHint options:[4]]
    LogicalFilter(condition=[$2])
      LogicalTableScan(table=[[likes$3]])
    LogicalFilter(condition=[=($13, 1)]) hints[DedupHint]
      LogicalProject(url=[$0], date=[$1], time=[$2], title=[$3], abstract=[$4], location=[$5], speakers=[$6], last_updated=[$7], id=[$8], full_text=[$9], embedding=[$10], startTime=[$11], startTimestamp=[$12], _rownum=[ROW_NUMBER() OVER (PARTITION BY $8 ORDER BY $7 DESC NULLS LAST)])
        LogicalTableScan(table=[[events$3]])

=== testAddInterest
ID:     testaddinterest$2
Type:   stream
Stage:  streams
Primary Key: _uuid
Timestamp  : event_time
Schema:
 - _uuid: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - userid: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - text: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - event_time: TIMESTAMP_WITH_LOCAL_TIME_ZONE(3) NOT NULL
Plan:
LogicalTableScan(table=[[testaddinterest$1]], hints=[[[WatermarkHint inheritPath:[] options:[3]]]]) hints[WatermarkHint options:[3]]

=== testLikes
ID:     testlikes$2
Type:   stream
Stage:  streams
Primary Key: _uuid
Timestamp  : event_time
Schema:
 - _uuid: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - eventId: BIGINT NOT NULL
 - userid: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - liked: BOOLEAN NOT NULL
 - event_time: TIMESTAMP_WITH_LOCAL_TIME_ZONE(3) NOT NULL
Plan:
LogicalTableScan(table=[[testlikes$1]], hints=[[[WatermarkHint inheritPath:[] options:[4]]]]) hints[WatermarkHint options:[4]]

=== UserInterests
ID:     userinterests$1
Type:   state
Stage:  streams
Inputs: userinterestvectors$1
Primary Key: userid
Timestamp  : __timestamp
Schema:
 - userid: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - interestVector: RAW('com.datasqrl.vector.FlinkVectorType', 'ADVjb20uZGF0YXNxcmwudmVjdG9yLkZsaW5rVmVjdG9yVHlwZVNlcmlhbGl6ZXJTbmFwc2hvdAAAAAEALWNvbS5kYXRhc3FybC52ZWN0b3IuRmxpbmtWZWN0b3JUeXBlU2VyaWFsaXplcg==')
 - __timestamp: TIMESTAMP_WITH_LOCAL_TIME_ZONE(3) NOT NULL
Plan:
LogicalAggregate(group=[{0}], interestVector=[center($1)], __timestamp=[MAX($2)])
  LogicalTableScan(table=[[userinterestvectors$1]])

=== UserInterestVectors
ID:     userinterestvectors$1
Type:   stream
Stage:  streams
Inputs: addinterest$3, likevector$1
Primary Key: __pk$0
Timestamp  : event_time
Schema:
 - userid: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - embedding: RAW('com.datasqrl.vector.FlinkVectorType', 'ADVjb20uZGF0YXNxcmwudmVjdG9yLkZsaW5rVmVjdG9yVHlwZVNlcmlhbGl6ZXJTbmFwc2hvdAAAAAEALWNvbS5kYXRhc3FybC52ZWN0b3IuRmxpbmtWZWN0b3JUeXBlU2VyaWFsaXplcg==')
 - event_time: TIMESTAMP_WITH_LOCAL_TIME_ZONE(3) NOT NULL
 - __pk$0: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
Plan:
LogicalUnion(all=[true])
  LogicalProject(userid=[$0], embedding=[$1], event_time=[$5], __pk$0=[$6])
    LogicalTableScan(table=[[likevector$1]])
  LogicalProject(userid=[$1], embedding=[$4], event_time=[$3], __pk$0=[$0])
    LogicalTableScan(table=[[addinterest$3]])

=== UserLikes
ID:     userlikes$1
Type:   state
Stage:  streams
Inputs: likes$3
Primary Key: userid, eventId
Timestamp  : event_time
Schema:
 - eventId: BIGINT NOT NULL
 - userid: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - liked: BOOLEAN NOT NULL
 - _uuid: VARCHAR(2147483647) CHARACTER SET "UTF-16LE" NOT NULL
 - event_time: TIMESTAMP_WITH_LOCAL_TIME_ZONE(3) NOT NULL
Post Processors:
 - topN: partition=userid, eventId limit=1 sort=#4: event_time TIMESTAMP_WITH_LOCAL_TIME_ZONE(3) DESC-nulls-last 
Plan:
LogicalTableScan(table=[[likes$3]])

