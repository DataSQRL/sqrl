>>>customer$15-lp-stream
LogicalProject(customerid$0=[$0], _uuid$0=[$1], _ingest_time$0=[$2], email$0=[$3], name$0=[$4], lastupdated$0=[$5], updatetime$0=[$6])
  LogicalProject(customerid$0=[$2], _uuid$0=[$0], _ingest_time$0=[$1], email$0=[$3], name$0=[$4], lastupdated$0=[$5], updatetime$3=[$6])
    LogicalProject(_uuid$0=[$0], _ingest_time$0=[$1], customerid$0=[$2], email$0=[$3], name$0=[$4], lastupdated$0=[$5], updatetime$3=[epochToTimestamp($5)]) hints[WatermarkHint options:[6]]
      LogicalTableScan(table=[[customer$i$10]])

>>>orders$3-lp-stream
LogicalProject(_uuid$0=[$0], _ingest_time$0=[$1], id$0=[$2], customerid$0=[$3], time$0=[$4])
  LogicalTableScan(table=[[orders$i$1]], hints=[[[WatermarkHint inheritPath:[] options:[4]]]]) hints[WatermarkHint options:[4]]

>>>orders_by_hour$26-lp-stream
LogicalProject(__customerid$0=[$0], hour$0=[$1], total_price$0=[$2], total_num$0=[$3])
  LogicalProject(__customerid$0$pk$1=[$0], hour=[$1], total_price=[$2], total_num=[$3])
    LogicalAggregate(group=[{0, 1}], total_price=[SUM($2)], total_num=[SUM($3)]) hints[TumbleAggregationHint options:[1, FUNCTION, 3, 3600000, 0]]
      LogicalProject(__customerid$0$pk$1=[$6], hour=[endOfHour($3)], price$0=[$4], num$0=[$5], _uuid$0=[$0])
        LogicalJoin(condition=[=($2, $6)], joinType=[inner]) hints[TemporalJoinHint options:[3, 6, 0]]
          LogicalProject(_uuid$0=[$0], id=[$2], customerid=[$3], time=[$4], price=[$7], num=[$8])
            LogicalJoin(condition=[AND(=($0, $6), =($10, $4))], joinType=[inner]) hints[IntervalJoin]
              LogicalTableScan(table=[[orders$i$1]], hints=[[[WatermarkHint inheritPath:[] options:[4]]]]) hints[WatermarkHint options:[4]]
              LogicalProject(___uuid$0$pk$1=[$0], price=[$2], num=[$3], discount=[$4], time$0=[$1])
                LogicalAggregate(group=[{0, 4}], price=[SUM($1)], num=[COUNT()], discount=[SUM($2)]) hints[TumbleAggregationHint options:[4, INSTANT, -1, 1, 0]]
                  LogicalProject(___uuid$0$pk$1=[$0], $f1=[-(*($8, $9), $10)], discount$0=[$10], _idx$0=[$6], time$0=[$4])
                    LogicalCorrelate(correlation=[$cor3], joinType=[inner], requiredColumns=[{5}])
                      LogicalTableScan(table=[[orders$i$1]], hints=[[[WatermarkHint inheritPath:[] options:[4]]]]) hints[WatermarkHint options:[4]]
                      Uncollect
                        LogicalProject($f0=[$cor3.entries$0])
                          LogicalValues(tuples=[[{ 0 }]])
          LogicalFilter(condition=[=($7, 1)]) hints[DedupHint]
            LogicalProject(customerid$0=[$0], _uuid$0=[$1], _ingest_time$0=[$2], email$0=[$3], name$0=[$4], lastupdated$0=[$5], updatetime$3=[$6], rownum=[ROW_NUMBER() OVER (PARTITION BY $0 ORDER BY $6 DESC NULLS LAST)])
              LogicalProject(customerid$0=[$2], _uuid$0=[$0], _ingest_time$0=[$1], email$0=[$3], name$0=[$4], lastupdated$0=[$5], updatetime$3=[$6])
                LogicalProject(_uuid$0=[$0], _ingest_time$0=[$1], customerid$0=[$2], email$0=[$3], name$0=[$4], lastupdated$0=[$5], updatetime$3=[epochToTimestamp($5)]) hints[WatermarkHint options:[6]]
                  LogicalTableScan(table=[[customer$i$10]])

>>>ordersinline$23-lp-stream
LogicalProject(_uuid$0=[$0], id$0=[$1], customerid$0=[$2], time$0=[$3], price$0=[$4], num$0=[$5])
  LogicalProject(_uuid$0=[$0], id=[$2], customerid=[$3], time=[$4], price=[$7], num=[$8])
    LogicalJoin(condition=[AND(=($0, $6), =($10, $4))], joinType=[inner]) hints[IntervalJoin]
      LogicalTableScan(table=[[orders$i$1]], hints=[[[WatermarkHint inheritPath:[] options:[4]]]]) hints[WatermarkHint options:[4]]
      LogicalProject(___uuid$0$pk$1=[$0], price=[$2], num=[$3], discount=[$4], time$0=[$1])
        LogicalAggregate(group=[{0, 4}], price=[SUM($1)], num=[COUNT()], discount=[SUM($2)]) hints[TumbleAggregationHint options:[4, INSTANT, -1, 1, 0]]
          LogicalProject(___uuid$0$pk$1=[$0], $f1=[-(*($8, $9), $10)], discount$0=[$10], _idx$0=[$6], time$0=[$4])
            LogicalCorrelate(correlation=[$cor3], joinType=[inner], requiredColumns=[{5}])
              LogicalTableScan(table=[[orders$i$1]], hints=[[[WatermarkHint inheritPath:[] options:[4]]]]) hints[WatermarkHint options:[4]]
              Uncollect
                LogicalProject($f0=[$cor3.entries$0])
                  LogicalValues(tuples=[[{ 0 }]])

>>>customer-lp-database
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalProject(customerid$0=[$0], _uuid$0=[$1], _ingest_time$0=[$2], email$0=[$3], name$0=[$4], lastupdated$0=[$5], updatetime$0=[$6])
    LogicalTableScan(table=[[customer$15]])

>>>orders-lp-database
LogicalSort(sort0=[$4], sort1=[$0], dir0=[DESC-nulls-last], dir1=[ASC])
  LogicalProject(_uuid$0=[$0], _ingest_time$0=[$1], id$0=[$2], customerid$0=[$3], time$0=[$4])
    LogicalTableScan(table=[[orders$3]])

>>>orders_by_hour-lp-database
LogicalSort(sort0=[$1], sort1=[$0], dir0=[DESC-nulls-last], dir1=[ASC])
  LogicalProject(__customerid$0=[$0], hour$0=[$1], total_price$0=[$2], total_num$0=[$3])
    LogicalTableScan(table=[[orders_by_hour$26]])

>>>ordersinline-lp-database
LogicalSort(sort0=[$3], sort1=[$0], dir0=[DESC-nulls-last], dir1=[ASC])
  LogicalProject(_uuid$0=[$0], id$0=[$1], customerid$0=[$2], time$0=[$3], price$0=[$4], num$0=[$5])
    LogicalTableScan(table=[[ordersinline$23]])

>>>customer-data
1000101, john.mekker@gmail.com, John Mekker, 1645396849, 2022-02-20T22:40:49Z
1000107, emily.ludies@hotmail.com, Emily F. Ludies, 1650493189, 2022-04-20T22:19:49Z
1000121, lalelu@hottunes.org, Michelle Dagnes, 1650493449, 2022-04-20T22:24:09Z
1000131, hotbear753@yahoo.com, Mark Spielman, 1650494449, 2022-04-20T22:40:49Z
>>>orders-data
10007140, 1000107, 2023-05-19T02:28:39.553244Z
10007543, 1000101, 2023-05-19T01:29:39.553244Z
10008231, 1000121, 2023-05-19T02:16:39.553244Z
10008434, 1000107, 2023-05-19T01:45:39.553244Z
>>>ordersinline-data
10007140, 1000107, 2023-05-19T02:28:39.553Z, 36.95, 2
10007543, 1000101, 2023-05-19T01:29:39.553Z, 120.85, 2
10008231, 1000121, 2023-05-19T02:16:39.553Z, 166.5, 2
10008434, 1000107, 2023-05-19T01:45:39.553Z, 41.95, 1
>>>orders_by_hour-data
2023-05-19T01:59:59.999Z, 120.85, 2
2023-05-19T01:59:59.999Z, 41.95, 1
2023-05-19T02:59:59.999Z, 166.5, 2
2023-05-19T02:59:59.999Z, 36.95, 2
