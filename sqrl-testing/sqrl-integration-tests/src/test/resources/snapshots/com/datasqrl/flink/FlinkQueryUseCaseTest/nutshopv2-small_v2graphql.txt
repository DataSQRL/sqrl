>>>database
CREATE INDEX IF NOT EXISTS orders$q$5_btree_c3c6 ON orders$q$5 USING btree (customerid,timestamp);
CREATE INDEX IF NOT EXISTS orders$q$5_hash_c2 ON orders$q$5 USING hash (id);
CREATE INDEX IF NOT EXISTS products$q$13_hash_c3 ON products$q$13 USING hash (name);
CREATE TABLE IF NOT EXISTS customers$q$16 (id BIGINT NOT NULL,timestamp TIMESTAMP WITH TIME ZONE NOT NULL , PRIMARY KEY (id));
CREATE TABLE IF NOT EXISTS items$6 (_uuid TEXT NOT NULL,_idx INTEGER NOT NULL,productid BIGINT NOT NULL,quantity BIGINT NOT NULL,unit_price DOUBLE PRECISION NOT NULL,discount DOUBLE PRECISION ,discount0 DOUBLE PRECISION NOT NULL,total DOUBLE PRECISION NOT NULL,__timestamp TIMESTAMP WITH TIME ZONE NOT NULL , PRIMARY KEY (_uuid,_idx));
CREATE TABLE IF NOT EXISTS orders$q$5 (_uuid TEXT NOT NULL,_ingest_time TIMESTAMP WITH TIME ZONE NOT NULL,id BIGINT NOT NULL,customerid BIGINT NOT NULL,time BIGINT NOT NULL,items bytea[] NOT NULL,timestamp TIMESTAMP WITH TIME ZONE NOT NULL , PRIMARY KEY (_uuid));
CREATE TABLE IF NOT EXISTS past_purchases$q$22 (__id$pk$3 BIGINT NOT NULL,productid BIGINT NOT NULL,num_orders BIGINT NOT NULL,total_quantity BIGINT NOT NULL,timestamp TIMESTAMP WITH TIME ZONE NOT NULL , PRIMARY KEY (__id$pk$3,productid));
CREATE TABLE IF NOT EXISTS products$q$13 (id BIGINT NOT NULL,_uuid TEXT NOT NULL,_ingest_time TIMESTAMP WITH TIME ZONE NOT NULL,name TEXT NOT NULL,sizing TEXT NOT NULL,weight_in_gram BIGINT NOT NULL,type TEXT NOT NULL,category TEXT NOT NULL,usda_id BIGINT NOT NULL,updated TIMESTAMP WITH TIME ZONE NOT NULL , PRIMARY KEY (id));
CREATE TABLE IF NOT EXISTS spending_by_month$q$19 (__id$pk$2 BIGINT NOT NULL,month TIMESTAMP WITH TIME ZONE NOT NULL,total_spend DOUBLE PRECISION NOT NULL,total_savings DOUBLE PRECISION NOT NULL , PRIMARY KEY (__id$pk$2,month));
CREATE TABLE IF NOT EXISTS totals$q$10 (___uuid$pk$1 TEXT NOT NULL,price DOUBLE PRECISION NOT NULL,savings DOUBLE PRECISION NOT NULL,timestamp TIMESTAMP WITH TIME ZONE NOT NULL , PRIMARY KEY (___uuid$pk$1));
CREATE TABLE IF NOT EXISTS volume_by_day$q$25 (__id$pk$4 BIGINT NOT NULL,day TIMESTAMP WITH TIME ZONE NOT NULL,quantity BIGINT NOT NULL,total DOUBLE PRECISION NOT NULL,total_weight BIGINT NOT NULL , PRIMARY KEY (__id$pk$4,day));
>>>query-allcustomers
{
  "data" : {
    "Customers" : [ {
      "id" : 1,
      "spending_by_month" : [ {
        "total_spend" : 225.77,
        "total_savings" : 14.73
      }, {
        "total_spend" : 95.53,
        "total_savings" : 1.24
      } ]
    }, {
      "id" : 2,
      "spending_by_month" : [ {
        "total_spend" : 336.64,
        "total_savings" : 50.49
      }, {
        "total_spend" : 139.86,
        "total_savings" : 29.08
      } ]
    }, {
      "id" : 3,
      "spending_by_month" : [ {
        "total_spend" : 20.64,
        "total_savings" : 0
      }, {
        "total_spend" : 53.94,
        "total_savings" : 0
      } ]
    }, {
      "id" : 4,
      "spending_by_month" : [ {
        "total_spend" : 98.75,
        "total_savings" : 7
      }, {
        "total_spend" : 118.5,
        "total_savings" : 18.28
      } ]
    }, {
      "id" : 5,
      "spending_by_month" : [ {
        "total_spend" : 149.08,
        "total_savings" : 4.43
      }, {
        "total_spend" : 105.55,
        "total_savings" : 65.73
      } ]
    }, {
      "id" : 6,
      "spending_by_month" : [ {
        "total_spend" : 172.84,
        "total_savings" : 12.64
      }, {
        "total_spend" : 36.55,
        "total_savings" : 16.87
      } ]
    }, {
      "id" : 7,
      "spending_by_month" : [ {
        "total_spend" : 86.94,
        "total_savings" : 7.94
      }, {
        "total_spend" : 23.83,
        "total_savings" : 0
      } ]
    }, {
      "id" : 8,
      "spending_by_month" : [ {
        "total_spend" : 118.54,
        "total_savings" : 7.26
      }, {
        "total_spend" : 17.59,
        "total_savings" : 5.27
      } ]
    }, {
      "id" : 9,
      "spending_by_month" : [ {
        "total_spend" : 78.83,
        "total_savings" : 5.95
      }, {
        "total_spend" : 94.36,
        "total_savings" : 21.88
      } ]
    }, {
      "id" : 10,
      "spending_by_month" : [ {
        "total_spend" : 104.33,
        "total_savings" : 35.41
      }, {
        "total_spend" : 84.18,
        "total_savings" : 4.24
      } ]
    } ]
  }
}
>>>query-customer
{
  "data" : {
    "Customers" : [ {
      "id" : 10,
      "spending_by_month" : [ {
        "total_spend" : 104.33,
        "total_savings" : 35.41
      }, {
        "total_spend" : 84.18,
        "total_savings" : 4.24
      } ]
    } ]
  }
}
