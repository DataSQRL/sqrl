>>>pipeline_explain.txt
=== _Applications
ID:          default_catalog.default_database._Applications
Type:        stream
Stage:       flink
Primary key: id, updated_at
Timestamp:   updated_at
---
Schema:
 - id: BIGINT NOT NULL
 - customer_id: BIGINT NOT NULL
 - loan_type_id: BIGINT NOT NULL
 - amount: DOUBLE NOT NULL
 - duration: BIGINT NOT NULL
 - application_date: TIMESTAMP_WITH_LOCAL_TIME_ZONE(3) NOT NULL
 - updated_at: TIMESTAMP_LTZ(3) *ROWTIME* NOT NULL
Inputs:
 - default_catalog.default_database._Applications__base
Annotations:
 - stream-root: _Applications

=== iceberg-sink
ID:          iceberg.iceberg-sink
Type:        export
Stage:       flink
---
Inputs:
 - default_catalog.default_database._Applications

>>>flink-sql-no-functions.sql
CREATE TEMPORARY TABLE `_Applications__schema` (
  `id` BIGINT NOT NULL,
  `customer_id` BIGINT NOT NULL,
  `loan_type_id` BIGINT NOT NULL,
  `amount` DOUBLE NOT NULL,
  `duration` BIGINT NOT NULL,
  `application_date` TIMESTAMP(3) WITH LOCAL TIME ZONE NOT NULL,
  `updated_at` TIMESTAMP(3) WITH LOCAL TIME ZONE NOT NULL
) WITH (
  'connector' = 'datagen'
);
CREATE TABLE `_Applications` (
  PRIMARY KEY (`id`, `updated_at`) NOT ENFORCED,
  WATERMARK FOR `updated_at` AS `updated_at` - INTERVAL '0.001' SECOND
) WITH (
  'format' = 'flexible-json',
  'path' = '${DATA_PATH}/applications.jsonl',
  'source.monitor-interval' = '10 sec',
  'connector' = 'filesystem'
)
LIKE `_Applications__schema`;
CREATE TEMPORARY TABLE `Iceberg_sink_ex1__schema` (
  `id` BIGINT NOT NULL,
  `customer_id` BIGINT NOT NULL,
  `loan_type_id` BIGINT NOT NULL,
  `amount` DOUBLE NOT NULL,
  `duration` BIGINT NOT NULL,
  `application_date` TIMESTAMP(3) WITH LOCAL TIME ZONE NOT NULL,
  `updated_at` TIMESTAMP(3) WITH LOCAL TIME ZONE NOT NULL
) WITH (
  'connector' = 'datagen'
);
CREATE TABLE `Iceberg_sink_ex1` (
  PRIMARY KEY (`id`, `updated_at`) NOT ENFORCED
) WITH (
  'connector' = 'iceberg',
  'catalog-table' = 'my-table',
  'warehouse' = '/tmp/duckdb',
  'catalog-type' = 'hadoop',
  'catalog-name' = 'mydatabase'
)
LIKE `Iceberg_sink_ex1__schema`;
EXECUTE STATEMENT SET BEGIN
INSERT INTO `default_catalog`.`default_database`.`Iceberg_sink_ex1`
SELECT *
 FROM `default_catalog`.`default_database`.`_Applications`
;
END
>>>iceberg-schema.sql

>>>iceberg-views.sql

