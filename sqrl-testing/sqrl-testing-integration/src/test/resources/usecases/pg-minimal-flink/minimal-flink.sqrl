CREATE TABLE SensorReading (
   sensorid INT NOT NULL,
   temperature FLOAT NOT NULL,
   event_time BIGINT NOT NULL,
   PRIMARY KEY (sensorid, event_time) NOT ENFORCED
) WITH (
    'connector' = 'datagen',
    'number-of-rows' = '10',
    'rows-per-second' = '10',
    'fields.sensorid.kind' = 'random',
    'fields.sensorid.min' = '1',
    'fields.sensorid.max' = '1',
    'fields.temperature.kind' = 'sequence',
    'fields.temperature.start' = '20',
    'fields.temperature.end' = '29',
     'fields.event_time.kind' = 'sequence',
     'fields.event_time.start' = '1750533400',
     'fields.event_time.end' = '1750533429'
);

SensorReadingById(sensorid INT NOT NULL):= SELECT * FROM SensorReading
                    WHERE sensorid = :sensorid ORDER BY event_time DESC;

SensorAggregate := SELECT sensorid, MAX(temperature) AS maxTemp, AVG(temperature) AS avgTemp
                   FROM SensorReading
                   GROUP BY sensorid ORDER BY sensorid ASC;

/*+test */
SensorAggregateTest := SELECT * FROM SensorAggregate ORDER BY sensorid ASC;

-- Test to make sure we do not break default Flink SQL -> PostgreSQL function mappings
/*+test */
PgDefaultMappingTest :=
    SELECT
        LOWER('ASD')                       AS lower_example,
        UPPER('bsd')                       AS upper_example,
        TRIM(' test  ')                    AS trim_example,
        LTRIM('  test')                    AS ltrim_example,
        RTRIM('test  ')                    AS rtrim_example,
        INITCAP('alice bob')               AS initcap_example,
        SUBSTRING('lorem ipsum', 5)        AS substring_example,
        MD5('test')                        AS md5_example,
        OVERLAY('test' PLACING '_' FROM 1) AS overlay_example;
