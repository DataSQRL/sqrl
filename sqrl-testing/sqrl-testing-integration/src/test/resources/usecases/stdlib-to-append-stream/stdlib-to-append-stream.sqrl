_InputValues := SELECT k, v
               FROM (VALUES ('a', 1),
                            ('b', 2),
                            ('a', 1),
                            ('c', 4),
                            ('b', 3),
                            ('a', 4),
                            ('c', 1),
                            ('b', 5),
                            ('d', 2),
                            ('e', 1)
               ) AS t(k, v);

InputAgg := SELECT k, SUM(v) AS v_sum FROM _InputValues GROUP BY k;

/*+ engine(flink) */
/*+ primary_key(k, v_sum) */
AppendStream := SELECT k, v_sum FROM to_append_stream(TABLE InputAgg);

/*+ test */
AppendStreamTest := SELECT * FROM AppendStream ORDER BY k ASC, v_sum DESC;

/*+ test */
InputAggTest := SELECT * FROM InputAgg ORDER BY k;
