IMPORT ecommerceTs.customer;
IMPORT ecommerceTs.orders;
JoinStream := SELECT o.id, c.name FROM Orders o JOIN Customer c on c.customerid = o.customerid;
DistinctCustomer := DISTINCT Customer ON customerid ORDER BY `timestamp` DESC;

EXPORT JoinStream TO log.JoinStream;
EXPORT DistinctCustomer TO log.DistinctStream;

CustomerSubset := SELECT customerid, name, `timestamp` FROM Customer;

/*+no_query */
CREATE TABLE CustomerExport (
    customerid BIGINT,
    name STRING,
    `timestamp` TIMESTAMP_LTZ(3) METADATA FROM 'timestamp'
);

EXPORT CustomerSubset TO CustomerExport;