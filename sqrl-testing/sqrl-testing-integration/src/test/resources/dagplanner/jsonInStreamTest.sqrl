IMPORT ecommerceTs.customer AS CustomerStream;
Customer := DISTINCT CustomerStream ON customerid ORDER BY `timestamp` DESC;
/*+ EXEC(process) */ toJsonTable := SELECT customerid, to_jsonb('{"a": 1}') AS obj FROM Customer;
/*+ EXEC(process) */ jsonArrayTable := SELECT customerid, jsonb_array(customerid) AS obj FROM Customer;
/*+ EXEC(process) */ jsonObjectAggTable := SELECT name, jsonb_object_agg('key', name) AS agg FROM Customer GROUP BY name;
/*+ EXEC(process) */ jsonToStringTable := SELECT customerid, jsonb_to_string(to_jsonb('{"a": 1}')) AS obj FROM Customer;
/*+ EXEC(process) */ jsonExtractTable := SELECT customerid, jsonb_extract(to_jsonb('{"a": "hello"}'), CAST('$.a' AS varchar), CAST('default' AS varchar)) AS obj FROM Customer;
/*+ EXEC(process) */ jsonQueryTable := SELECT customerid, jsonb_query(to_jsonb('{"a": {"b": 1}}'), '$.a') AS obj FROM Customer;
/*+ EXEC(process) */ jsonExistsTable := SELECT customerid, jsonb_exists(to_jsonb('{"a": true}'), '$.a') AS obj FROM Customer;
/*+ EXEC(process) */ jsonConcatTable := SELECT customerid, jsonb_concat(to_jsonb('{"a": true}'), to_jsonb('{"a": false}')) AS obj FROM Customer;
/*+ EXEC(process) */ jsonArrayAggTable := SELECT name, jsonb_array_agg(name) AS agg FROM Customer GROUP BY name;
/*+ EXEC(process) */ ObjComplex := SELECT customerid, jsonb_object(concat('application#',CAST(name AS VARCHAR)), customerid) AS obj FROM Customer;
